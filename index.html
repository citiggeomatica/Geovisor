<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Geovisor Colaborativo - Repositorio GIS Din谩mico</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            background: #f0f2f5;
        }

        .container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        #map {
            flex: 1;
            height: 100vh;
            transition: all 0.3s ease;
            min-width: 0;
        }

        .sidebar {
            width: 0;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            z-index: 500;
            position: relative;
        }

        .sidebar.active {
            width: 450px;
            min-width: 450px;
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        
        /* Tablets (768px - 1024px) */
        @media screen and (max-width: 1024px) {
            .sidebar.active {
                width: 380px;
                min-width: 380px;
            }
            
            .stat-card .number {
                font-size: 20px;
            }
            
            .stat-card .label {
                font-size: 10px;
            }
        }

        /* M贸viles (< 768px) */
        @media screen and (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                right: 0;
                height: 100vh;
                width: 0;
                z-index: 1000;
            }
            
            .sidebar.active {
                width: 100%;
                min-width: 100%;
            }
            
            .sidebar-header h2 {
                font-size: 18px;
            }
            
            .sidebar-header .subtitle {
                font-size: 12px;
            }
            
            .stats-bar {
                flex-wrap: wrap;
                gap: 8px;
                padding: 12px;
            }
            
            .stat-card {
                flex: 1 1 calc(50% - 4px);
                min-width: calc(50% - 4px);
                padding: 8px;
            }
            
            .stat-card .number {
                font-size: 18px;
            }
            
            .stat-card .label {
                font-size: 9px;
            }
            
            .source-card {
                padding: 12px;
            }
            
            .search-box {
                padding: 12px;
            }
            
            .sidebar-content {
                padding: 12px;
            }
        }

        /* M贸viles peque帽os (< 480px) */
        @media screen and (max-width: 480px) {
            .sidebar-header {
                padding: 15px;
            }
            
            .sidebar-header h2 {
                font-size: 16px;
            }
            
            .contribute-banner h3 {
                font-size: 14px;
            }
            
            .contribute-banner p {
                font-size: 11px;
            }
            
            .stats-bar {
                padding: 10px;
            }
            
            .stat-card .number {
                font-size: 16px;
            }
            
            .source-card h3 {
                font-size: 14px;
            }
            
            .tipo-badge {
                font-size: 10px;
                padding: 3px 8px;
            }
        }

        .sidebar-header {
            background: linear-gradient(135deg, #059669 0%, #065f46 100%);
            color: white;
            padding: 18px;
            position: relative;
        }

        .sidebar-header h2 {
            font-size: 20px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-header .subtitle {
            font-size: 13px;
            opacity: 0.9;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .contribute-banner {
            background: linear-gradient(135deg, #059669 0%, #065f46 100%);
            padding: 15px 20px;
            margin: 0;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid rgba(0,0,0,0.1);
            color: white;
        }

        .contribute-banner:hover {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .contribute-banner h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .contribute-banner p {
            margin: 0;
            font-size: 12px;
            opacity: 0.95;
        }

        .refresh-banner {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            padding: 12px 20px;
            margin: 0;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid rgba(0,0,0,0.1);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .refresh-banner:hover {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
        }

        .refresh-banner.loading {
            background: linear-gradient(135deg, #a7f3d0 0%, #065f46 100%);
            cursor: wait;
        }

        .refresh-banner .last-update {
            font-size: 11px;
            opacity: 0.9;
        }

        .search-box {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }

        .stats-bar {
            display: flex;
            padding: 15px;
            gap: 10px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }

        .stat-card {
            flex: 1;
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .stat-card .number {
            font-size: 24px;
            font-weight: bold;
            color: #059669;
        }

        .stat-card .label {
            font-size: 11px;
            color: #666;
            margin-top: 3px;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .source-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 14px;
            margin-bottom: 12px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .source-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
            border-color: #059669;
        }

        .source-card::after {
            content: "馃敆";
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 18px;
            opacity: 0;
            transition: all 0.3s;
            pointer-events: none;
            z-index: 0;
        }

        .source-card:hover::after {
            opacity: 0;
        }

        .source-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .source-name {
            font-weight: 600;
            font-size: 15px;
            color: #333;
            flex: 1;
            padding-right: 30px;
        }

        .source-type {
            background: #059669;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 10px;
            white-space: nowrap;
        }

        .source-details {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 8px;
            margin-top: 10px;
            font-size: 13px;
        }

        .detail-label {
            color: #666;
            font-weight: 500;
        }

        .detail-value {
            color: #333;
        }

        .access-badge {
            display: inline-block;
            background: #059669;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
        }

        .access-badge.warning {
            background: #ff9800;
        }

        .layers-tag {
            display: inline-block;
            background: #f0f0f0;
            color: #555;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 11px;
            margin: 2px;
        }

        .header {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        body.left-panel-open .header {
            left: 430px;
        }

        .header h1 {
            font-size: 20px;
            color: #333;
            margin-bottom: 5px;
        }

        /* Responsive para header */
        @media screen and (max-width: 768px) {
            .header {
                top: 15px;
                left: 15px;
                padding: 12px 18px;
            }
            
            .header h1 {
                font-size: 16px;
            }
            
            .header p {
                font-size: 11px;
            }
            
            body.left-panel-open .header {
                left: 15px;
            }
        }

        @media screen and (max-width: 480px) {
            .header {
                top: 10px;
                left: 10px;
                padding: 10px 15px;
            }
            
            .header h1 {
                font-size: 14px;
                margin-bottom: 3px;
            }
            
            .header p {
                font-size: 10px;
            }
        }

        .header p {
            font-size: 13px;
            color: #666;
        }

        .legend {
            position: absolute;
            bottom: 30px;
            left: 20px;
            z-index: 400;
            background: white;
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            max-width: 200px;
            transition: all 0.3s ease;
        }
        
        body.left-panel-open .legend {
            left: 430px;
        }

        .legend h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: #333;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Responsive para leyenda */
        @media screen and (max-width: 768px) {
            .legend {
                bottom: 20px;
                left: 15px;
                max-width: 160px;
                padding: 10px;
            }
            
            .legend h3 {
                font-size: 12px;
                margin-bottom: 8px;
            }
            
            .legend-item {
                margin: 6px 0;
                font-size: 11px;
            }
            
            .legend-color {
                width: 16px;
                height: 16px;
                margin-right: 8px;
            }
            
            body.left-panel-open .legend {
                left: 15px;
            }
        }

        @media screen and (max-width: 480px) {
            .legend {
                bottom: 15px;
                left: 10px;
                max-width: 140px;
                padding: 8px;
            }
            
            .legend h3 {
                font-size: 11px;
                margin-bottom: 6px;
            }
            
            .legend-item {
                margin: 5px 0;
                font-size: 10px;
            }
            
            .legend-color {
                width: 14px;
                height: 14px;
                margin-right: 6px;
            }
        }

        .custom-popup {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .custom-popup h3 {
            margin: 0 0 8px 0;
            color: #059669;
            font-size: 16px;
        }

        .custom-popup p {
            margin: 5px 0;
            font-size: 13px;
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .source-card {
            animation: fadeIn 0.3s ease;
        }

        .sidebar-content::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: #059669;
            border-radius: 4px;
        }

        .sidebar-content::-webkit-scrollbar-thumb:hover {
            background: #047857;
        }

        .spin {
            animation: spin 1s linear infinite;
        }

        /* ==================== MEJORAS PARA DISPOSITIVOS T脕CTILES ==================== */
        @media screen and (max-width: 768px) {
            /* Mejorar 谩rea de toque para botones peque帽os */
            .action-icon,
            .gc-actions button {
                min-width: 40px;
                min-height: 40px;
            }
            
            .close-btn {
                min-width: 40px;
                min-height: 40px;
            }
            
            .lp-close {
                min-width: 40px;
                min-height: 40px;
            }
            
            /* Ajustar scroll para mejor experiencia m贸vil */
            .sidebar-content,
            .lp-content {
                -webkit-overflow-scrolling: touch;
            }
            
            /* Ocultar scrollbars en m贸viles para m谩s espacio */
            .sidebar-content::-webkit-scrollbar,
            .lp-content::-webkit-scrollbar {
                width: 4px;
            }
            
            /* Mejorar legibilidad de textos */
            body {
                -webkit-text-size-adjust: 100%;
                text-size-adjust: 100%;
            }
        }

        /* Modo landscape en m贸viles */
        @media screen and (max-width: 768px) and (orientation: landscape) {
            .header {
                padding: 8px 12px;
            }
            
            .header h1 {
                font-size: 14px;
            }
            
            .header p {
                display: none; /* Ocultar subt铆tulo en landscape para ahorrar espacio */
            }
            
            .legend {
                bottom: 10px;
                left: 10px;
                max-width: 120px;
                padding: 6px;
            }
            
            .legend h3 {
                font-size: 10px;
            }
            
            .legend-item {
                font-size: 9px;
            }
        }
    
        /* Modal Formulario */
        .modal-form {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
        }
        .modal-box {
            background: white;
            margin: 50px auto;
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        /* Responsive para modales */
        @media screen and (max-width: 768px) {
            .modal-box {
                margin: 30px auto;
                width: 95%;
            }
            
            .modal-head {
                padding: 20px;
            }
            
            .modal-head h2 {
                font-size: 20px;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .modal-foot {
                padding: 12px 20px;
            }
        }

        @media screen and (max-width: 480px) {
            .modal-box {
                margin: 10px;
                width: calc(100% - 20px);
                border-radius: 12px;
            }
            
            .modal-head {
                padding: 15px;
            }
            
            .modal-head h2 {
                font-size: 18px;
            }
            
            .modal-head p {
                font-size: 12px;
            }
            
            .modal-body {
                padding: 15px;
            }
            
            .grupo {
                margin-bottom: 12px;
            }
            
            .btn-modal {
                padding: 8px 15px;
                font-size: 13px;
            }
        }

        .modal-head {
            background: linear-gradient(135deg, #059669 0%, #065f46 100%);
            color: white;
            padding: 25px;
            border-radius: 15px 15px 0 0;
        }
        .modal-head h2 { margin: 0; font-size: 24px; }
        .modal-head p { margin: 5px 0 0 0; font-size: 14px; opacity: 0.9; }
        .modal-body { padding: 25px; }
        .grupo { margin-bottom: 15px; }
        .grupo label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 5px; 
            font-size: 14px;
        }
        .grupo label .req { color: #f44336; }
        .grupo input,
        .grupo select,
        .grupo textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }
        .grupo input:focus,
        .grupo select:focus,
        .grupo textarea:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }
        .grupo textarea { min-height: 70px; resize: vertical; }
        .modal-foot {
            padding: 15px 25px;
            border-top: 1px solid #e0e0e0;
            text-align: right;
        }
        .btn-modal {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 5px;
        }
        .btn-pri { background: #059669; color: white; }
        .btn-sec { background: #e0e0e0; color: #666; }
        .notif {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #059669;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 3000;
        }
        .notif.err { background: #f44336; }

        /* Responsive para notificaciones */
        @media screen and (max-width: 768px) {
            .notif {
                top: 15px;
                right: 15px;
                left: 15px;
                padding: 12px 15px;
                font-size: 13px;
            }
        }

        @media screen and (max-width: 480px) {
            .notif {
                top: 10px;
                right: 10px;
                left: 10px;
                padding: 10px 12px;
                font-size: 12px;
            }
        }

        /* Bot贸n flotante agregar pa铆s */
        .fab-add-country {
            position: absolute;
            bottom: 30px;
            right: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, #059669 0%, #065f46 100%);
            color: white;
            border: none;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            font-size: 26px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(5, 150, 105, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .fab-add-country:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(5, 150, 105, 0.7);
        }

        /* Responsive para bot贸n flotante */
        @media screen and (max-width: 768px) {
            .fab-add-country {
                bottom: 20px;
                right: 15px;
                width: 50px;
                height: 50px;
                font-size: 22px;
            }
        }

        @media screen and (max-width: 480px) {
            .fab-add-country {
                bottom: 15px;
                right: 10px;
                width: 48px;
                height: 48px;
                font-size: 20px;
            }
            
            .fab-add-country .fab-tooltip {
                display: none; /* Ocultar tooltip en m贸viles para ahorrar espacio */
            }
        }

        .fab-add-country .fab-tooltip {
            position: absolute;
            right: 66px;
            background: #333;
            color: white;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 13px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }
        .fab-add-country:hover .fab-tooltip {
            opacity: 1;
        }

        /* Modal agregar pa铆s */
        .modal-pais { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); }
        .modal-pais .modal-box { background: white; margin: 40px auto; width: 92%; max-width: 520px; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .modal-pais .modal-head { background: linear-gradient(135deg, #059669 0%, #065f46 100%); color: white; padding: 25px; }
        .modal-pais .modal-head h2 { margin: 0; font-size: 22px; }
        .modal-pais .modal-head p { margin: 5px 0 0; font-size: 13px; opacity: 0.9; }
        .modal-pais .modal-body { padding: 25px; }
        .modal-pais .modal-foot { padding: 15px 25px; border-top: 1px solid #e0e0e0; text-align: right; display: flex; gap: 8px; justify-content: flex-end; }
        
        .coord-picker-area {
            background: #ecfdf5;
            border: 2px dashed #10b981;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            margin-top: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .coord-picker-area:hover { background: #d1fae5; border-color: #059669; }
        .coord-picker-area.picked { border-style: solid; background: #d1fae5; border-color: #059669; }
        .coord-picker-area .coord-icon { font-size: 28px; margin-bottom: 5px; }
        .coord-picker-area .coord-text { font-size: 13px; color: #555; }
        .coord-picker-area .coord-values { font-size: 14px; font-weight: 600; color: #333; margin-top: 5px; }

        /* Responsive para coord-picker */
        @media screen and (max-width: 768px) {
            .coord-picker-area {
                padding: 12px;
            }
            
            .coord-picker-area .coord-icon {
                font-size: 24px;
            }
            
            .coord-picker-area .coord-text {
                font-size: 12px;
            }
            
            .coord-picker-area .coord-values {
                font-size: 13px;
            }
        }

        @media screen and (max-width: 480px) {
            .coord-picker-area {
                padding: 10px;
            }
            
            .coord-picker-area .coord-icon {
                font-size: 22px;
                margin-bottom: 3px;
            }
            
            .coord-picker-area .coord-text {
                font-size: 11px;
            }
            
            .coord-picker-area .coord-values {
                font-size: 12px;
            }
        }

        .map-picking-mode { cursor: crosshair !important; }
        .map-picking-mode .leaflet-container { cursor: crosshair !important; }

        .picking-banner {
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1500;
            background: linear-gradient(135deg, #059669 0%, #065f46 100%);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            display: none;
            animation: fadeIn 0.3s ease;
            text-align: center;
        }
        .picking-banner .cancel-pick {
            background: rgba(255,255,255,0.25);
            border: none;
            color: white;
            padding: 4px 14px;
            border-radius: 15px;
            cursor: pointer;
            margin-left: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .picking-banner .cancel-pick:hover { background: rgba(255,255,255,0.4); }

        /* Responsive para picking-banner */
        @media screen and (max-width: 768px) {
            .picking-banner {
                top: 70px;
                padding: 10px 25px;
                font-size: 13px;
            }
            
            .picking-banner .cancel-pick {
                padding: 4px 12px;
                font-size: 11px;
            }
        }

        @media screen and (max-width: 480px) {
            .picking-banner {
                top: 60px;
                padding: 8px 15px;
                font-size: 12px;
                left: 10px;
                right: 10px;
                transform: none;
                width: calc(100% - 20px);
            }
            
            .picking-banner .cancel-pick {
                padding: 3px 10px;
                font-size: 10px;
                margin-left: 8px;
            }
        }

        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 4px;
            max-height: 120px;
            overflow-y: auto;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 8px;
            margin-top: 5px;
        }
        .emoji-grid .emoji-opt {
            width: 100%;
            aspect-ratio: 1;
            border: 2px solid transparent;
            border-radius: 6px;
            background: white;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
        }
        .emoji-grid .emoji-opt:hover { background: #d1fae5; border-color: #10b981; transform: scale(1.15); }
        .emoji-grid .emoji-opt.selected { border-color: #059669; background: #dbeafe; box-shadow: 0 0 0 2px rgba(5,150,105,0.3); }

        /* Responsive para emoji-grid */
        @media screen and (max-width: 768px) {
            .emoji-grid {
                grid-template-columns: repeat(6, 1fr);
                max-height: 100px;
            }
            
            .emoji-grid .emoji-opt {
                font-size: 18px;
            }
        }

        @media screen and (max-width: 480px) {
            .emoji-grid {
                grid-template-columns: repeat(5, 1fr);
                max-height: 90px;
                gap: 3px;
                padding: 6px;
            }
            
            .emoji-grid .emoji-opt {
                font-size: 16px;
            }
        }

        /* Banner eliminar pa铆s */
        .delete-country-banner {
            background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%);
            padding: 12px 20px;
            margin: 0;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid rgba(0,0,0,0.1);
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
        }
        .delete-country-banner:hover {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
        }

    
        .source-actions {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 2;
        }
        
        .source-card:hover .source-actions {
            opacity: 1;
        }
        
        .action-icon {
            background: white;
            border: 1px solid #e0e0e0;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            position: relative;
            z-index: 3;
            padding: 0;
            line-height: 1;
            -webkit-appearance: none;
            appearance: none;
            outline: none;
        }
        
        .action-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .action-icon.edit:hover {
            background: #059669;
            color: white;
            border-color: #059669;
        }
        
        .action-icon.delete:hover {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .modal-head .mode-badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-left: 10px;
        }

    </style>
    <!-- LEFT PANEL STYLES -->
    <style>
        .left-panel {
            width: 0;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            order: -1;
            z-index: 500;
            position: relative;
        }
        .left-panel.active { 
            width: 400px;
            min-width: 400px;
        }

        /* Responsive para left-panel */
        @media screen and (max-width: 1024px) {
            .left-panel.active {
                width: 350px;
                min-width: 350px;
            }
        }

        @media screen and (max-width: 768px) {
            .left-panel {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                width: 0;
                z-index: 1000;
            }
            
            .left-panel.active {
                width: 100%;
                min-width: 100%;
            }
        }

        .left-panel .lp-header {
            background: linear-gradient(135deg, #065f46 0%, #047857 100%);
            color: white;
            padding: 16px 18px;
            position: relative;
        }
        .left-panel .lp-header h2 { 
            font-size: 18px; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            margin-bottom: 3px; 
        }
        .left-panel .lp-header .subtitle { 
            font-size: 11px; 
            opacity: 0.85; 
        }
        .left-panel .lp-close {
            position: absolute; top: 12px; right: 12px;
            background: rgba(255,255,255,0.2); border: none; color: white;
            width: 30px; height: 30px; border-radius: 50%; cursor: pointer;
            font-size: 18px; display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .left-panel .lp-close:hover { background: rgba(255,255,255,0.35); transform: rotate(90deg); }

        .lp-add-banner {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            padding: 12px 20px; text-align: center; cursor: pointer;
            transition: all 0.3s; border-bottom: 2px solid rgba(0,0,0,0.1); color: white;
        }
        .lp-add-banner:hover { background: linear-gradient(135deg, #10b981 0%, #34d399 100%); }
        .lp-add-banner h3 { margin: 0 0 3px; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .lp-add-banner p { margin: 0; font-size: 11px; opacity: 0.9; }

        .lp-filters {
            padding: 12px 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .lp-filters select, .lp-filters input {
            padding: 7px 10px; border: 1px solid #ddd; border-radius: 6px;
            font-size: 12px; flex: 1; min-width: 0;
        }
        .lp-filters select:focus, .lp-filters input:focus { outline: none; border-color: #065f46; }
        .lp-search { flex-basis: 100% !important; }

        .lp-stats {
            display: flex; padding: 10px 15px; gap: 8px;
            background: #ecfdf5; border-bottom: 1px solid #e0e0e0;
        }
        .lp-stat {
            flex: 1; background: white; padding: 8px; border-radius: 6px;
            text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .lp-stat .num { font-size: 18px; font-weight: bold; color: #065f46; }
        .lp-stat .lbl { font-size: 10px; color: #666; margin-top: 2px; }

        .lp-content {
            flex: 1; 
            overflow-y: auto; 
            padding: 12px;
        }
        .lp-content::-webkit-scrollbar { width: 6px; }
        .lp-content::-webkit-scrollbar-thumb { background: #047857; border-radius: 3px; }

        .gis-card {
            background: white; 
            border: 1px solid #e0e0e0; 
            border-radius: 8px;
            padding: 12px; 
            margin-bottom: 10px; 
            transition: all 0.2s;
            position: relative; 
            animation: fadeIn 0.3s ease;
        }
        .gis-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-1px); 
            border-color: #065f46;
        }
        .gis-card .gc-actions {
            position: absolute; top: 10px; right: 10px;
            display: flex; gap: 4px; opacity: 0; transition: opacity 0.2s; z-index: 2;
        }
        .gis-card:hover .gc-actions { opacity: 1; }
        .gis-card .gc-actions button {
            background: white; border: 1px solid #ddd; width: 28px; height: 28px;
            border-radius: 50%; cursor: pointer; font-size: 12px;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.2s; padding: 0; z-index: 3; position: relative;
        }
        .gis-card .gc-actions button.gc-edit:hover { background: #047857; color: white; border-color: #065f46; }
        .gis-card .gc-actions button.gc-del:hover { background: #e74c3c; color: white; border-color: #e74c3c; }

        .gc-name { 
            font-weight: 600; 
            font-size: 13px; 
            color: #2c3e50; 
            padding-right: 60px; 
            margin-bottom: 5px; 
        }
        .gc-desc { 
            font-size: 11px; 
            color: #666; 
            line-height: 1.4; 
            margin-bottom: 8px; 
        }
        .gc-footer { display: flex; justify-content: space-between; align-items: center; gap: 6px; flex-wrap: wrap; }
        .gc-badge {
            display: inline-block; padding: 2px 8px; border-radius: 10px;
            font-size: 10px; font-weight: 600; color: white;
        }
        .gc-badge.global { background: #059669; }
        .gc-badge.latam { background: #e74c3c; }
        .gc-badge.spain { background: #f39c12; }
        .gc-badge.fisica { background: #16a34a; }
        .gc-badge.humana { background: #0891b2; }
        .gc-link {
            background: linear-gradient(135deg, #065f46, #047857);
            color: white; padding: 4px 12px; border-radius: 5px;
            text-decoration: none; font-size: 11px; font-weight: 600;
            transition: all 0.2s; white-space: nowrap;
        }
        .gc-link:hover { transform: scale(1.05); box-shadow: 0 2px 8px rgba(5,150,105,0.4); }

        /* Toggle button left panel */
        .fab-global {
            position: absolute; top: 85px; left: 20px; z-index: 1000;
            background: linear-gradient(135deg, #065f46 0%, #047857 100%);
            color: white; border: none; padding: 10px 18px;
            border-radius: 25px; cursor: pointer; font-size: 13px; font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: flex; align-items: center; gap: 8px; transition: all 0.3s;
        }
        .fab-global:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
        
        /* Responsive para fab-global */
        @media screen and (max-width: 768px) {
            .fab-global {
                top: 75px;
                left: 15px;
                padding: 8px 15px;
                font-size: 12px;
            }
        }

        @media screen and (max-width: 480px) {
            .fab-global {
                top: 65px;
                left: 10px;
                padding: 7px 12px;
                font-size: 11px;
            }
            
            .fab-global .fab-count {
                padding: 2px 6px;
                font-size: 10px;
            }
        }
        
        body.left-panel-open .fab-global {
            opacity: 0;
            pointer-events: none;
        }
        .fab-global .fab-count {
            background: rgba(255,255,255,0.25); padding: 2px 8px; border-radius: 10px; font-size: 11px;
        }

        /* Modal global source */
        .modal-gis { display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.7); }
        .modal-gis .modal-box { background:white; margin:40px auto; width:92%; max-width:500px; border-radius:15px; box-shadow:0 20px 60px rgba(0,0,0,0.3); overflow:hidden; }
        .modal-gis .modal-head { background:linear-gradient(135deg,#134e4a,#047857); color:white; padding:22px; }
        .modal-gis .modal-head h2 { margin:0; font-size:20px; }
        .modal-gis .modal-head p { margin:4px 0 0; font-size:12px; opacity:0.85; }
        .modal-gis .modal-body { padding:20px; }
        .modal-gis .modal-foot { padding:12px 20px; border-top:1px solid #e0e0e0; text-align:right; }
    </style>
</head>
<body>
    <div class="header">
        <h1>馃寧 Geovisor Colaborativo GIS</h1>
        <p>Repositorio din谩mico de informaci贸n geoespacial </p>
    </div>

    <div class="container">
        <!-- LEFT PANEL: Global GIS Data -->
        <div class="left-panel" id="leftPanel">
            <div class="lp-header">
                <h2>馃寪 Datos GIS Globales</h2>
                <div class="subtitle">Fuentes de datos GIS de cobertura mundial</div>
                <button class="lp-close" onclick="toggleLeftPanel()">脳</button>
            </div>
            <div class="lp-add-banner" onclick="abrirModalGlobal()">
                <h3><span>鉃?/span> AGREGAR FUENTE GLOBAL</h3>
                <p>A帽ade una nueva fuente de datos GIS mundial</p>
            </div>
            <div class="lp-filters">
                <select id="gCategory" onchange="filtrarGlobal()">
                    <option value="all">馃搳 Categor铆a</option>
                    <option value="fisica">Geo. F铆sica</option>
                    <option value="humana">Geo. Humana</option>
                </select>
                <select id="gType" onchange="filtrarGlobal()">
                    <option value="all">馃搧 Tipo</option>
                    <option value="elevacion">Elevaci贸n</option>
                    <option value="clima">Clima</option>
                    <option value="hidrologia">Hidrolog铆a</option>
                    <option value="cobertura">Cobertura</option>
                    <option value="limites">L铆mites</option>
                    <option value="poblacion">Poblaci贸n</option>
                    <option value="transporte">Transporte</option>
                    <option value="ecologia">Ecolog铆a</option>
                    <option value="desastres">Desastres</option>
                    <option value="geologia">Geolog铆a</option>
                </select>
                <input type="text" id="gSearch" class="lp-search" placeholder="馃攳 Buscar fuentes globales..." oninput="filtrarGlobal()">
            </div>
            <div class="lp-stats">
                <div class="lp-stat"><div class="num" id="gTotal">0</div><div class="lbl">Mostrando</div></div>
                <div class="lp-stat"><div class="num" id="gFisica">0</div><div class="lbl">F铆sica</div></div>
                <div class="lp-stat"><div class="num" id="gHumana">0</div><div class="lbl">Humana</div></div>
            </div>
            <div class="lp-content" id="gList"></div>
        </div>

        <div id="map"></div>
        
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 id="country-name">
                    <span class="country-flag" id="country-flag"></span>
                    <span id="country-text"></span>
                </h2>
                <div class="subtitle" id="country-subtitle">Fuentes de datos GIS disponibles</div>
                <button class="close-btn" onclick="closeSidebar()">脳</button>
            </div>

            <div class="contribute-banner" onclick="abrirFormulario()">
                <h3>
                    <span>馃摑</span>
                    <span>AGREGAR NUEVA FUENTE GIS</span>
                </h3>
                <p>Completa el formulario y actualiza el mapa en tiempo real</p>
            </div>

            <div class="refresh-banner" id="refresh-btn" onclick="refreshCountryData()" style="display:none;">
                <span id="refresh-icon">馃攧</span>
                <div>
                    <div style="font-weight: 600;">Actualizar desde Google Sheets</div>
                    <div class="last-update" id="last-update">脷ltima actualizaci贸n: Datos locales</div>
                </div>
            </div>
            
            <div class="stats-bar">
                <div class="stat-card">
                    <div class="number" id="total-sources">0</div>
                    <div class="label">Total Fuentes</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="total-types">0</div>
                    <div class="label">Tipos de Datos</div>
                </div>
            </div>

            <!-- Banner eliminar pa铆s (solo visible con 0 fuentes) -->
            <div class="delete-country-banner" id="deleteCountryBanner" style="display:none;" onclick="eliminarPais()">
                <span>馃棏锔?/span>
                <div>
                    <div style="font-weight: 600;">Eliminar este pa铆s del mapa</div>
                    <div style="font-size: 11px; opacity: 0.9;">Sin fuentes de datos 鈥?clic para eliminar el punto</div>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="search-input" placeholder="馃攳 Buscar fuentes de datos...">
            </div>
            
            <div class="sidebar-content" id="sources-list"></div>
        </div>
    </div>

    <div class="legend">
        <h3>馃搷 Pa铆ses con Datos</h3>
        <div class="legend-item">
            <div class="legend-color" style="background: #10b981;"></div>
            <span>Haz clic en un pa铆s</span>
        </div>
        <div class="legend-item" style="margin-top: 15px; border-top: 1px solid #e0e0e0; padding-top: 10px;">
            <span style="font-size: 11px; color: #666;">Total: <strong id="total-countries-legend">12 pa铆ses</strong><br><strong id="total-global-sources">243 fuentes</strong></span>
        </div>
    </div>

    <!-- Bot贸n abrir panel global -->
    <button class="fab-global" id="fabGlobal" onclick="toggleLeftPanel()">
        馃寪 Datos Globales <span class="fab-count" id="fabGlobalCount">37</span>
    </button>

    <!-- Bot贸n flotante agregar pa铆s -->
    <button class="fab-add-country" onclick="abrirModalPais()" title="Agregar nuevo pa铆s">
        <span class="fab-tooltip">Agregar nuevo pa铆s</span>
        馃實+
    </button>

    <!-- Banner modo selecci贸n coordenadas -->
    <div class="picking-banner" id="pickingBanner">
        馃搷 Haz clic en el mapa para ubicar el pa铆s
        <button class="cancel-pick" onclick="cancelarPicking()">鉁?Cancelar</button>
    </div>

    <script>
const paisesData = {
        "M茅xico": {
                "coords": [
                        -102.552784,
                        23.634501
                ],
                "flag": "馃嚥馃嚱",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1sfGs2tlrtPZX-k3HMTcc5MbqWkdwTxia/edit?gid=696844482#gid=696844482",
                "sheet_id": "1sfGs2tlrtPZX-k3HMTcc5MbqWkdwTxia",
                "gid": "696844482",
                "fuentes": [
                        {
                                "FUENTE": "IDEA",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.gits.igg.unam.mx/idea/descarga",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Recursos naturales,Nombres geogr谩ficos, Datos catastrales, Rasgos hidrogr谩ficos, V铆as de comunicaci贸n y rasgos planim茅tricos, Im谩genes,Datos de relieve, L铆mites costeros, internacionales, estatales, y municipales,Referencias geod茅sicas"
                        },
                        {
                                "FUENTE": "GEOPORTAL CONABIO",
                                "Tipo": ".SHP,TIF,KML",
                                "ENLACE": "http://geoportal.conabio.gob.mx/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Biodiversidad ,Climatolog铆a ,Divisi贸n pol铆tica Edafolog铆aGeolog铆aHidrolog铆a Poblaci贸n \nProducci贸n Productos satelitales Regionalizaci贸n Riesgo Topograf铆aVegetaci贸n y uso de suelo"
                        },
                        {
                                "FUENTE": "SGM",
                                "Tipo": "SHP GEOLOGIA",
                                "ENLACE": "https://www.sgm.gob.mx/GeoInfoMexGobMx/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "cartograf铆a geol贸gica"
                        },
                        {
                                "FUENTE": "GEOINFORMACI脫N CONABIO",
                                "Tipo": "SHP,KML",
                                "ENLACE": "http://www.conabio.gob.mx/informacion/gis/?vns=gis_root/edafo/tsuelo/eda251mgw",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "DATOS ABIERTOS",
                                "Tipo": "SHP,EXCEL",
                                "ENLACE": "https://datos.gob.mx/busca/dataset?res_format=SHP",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "SIGCDMX",
                                "Tipo": "shp",
                                "ENLACE": "https://sig.cdmx.gob.mx/datos/descarga",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Descarga de datos del catastro"
                        },
                        {
                                "FUENTE": "CONANP",
                                "Tipo": "SHP",
                                "ENLACE": "https://sig.conanp.gob.mx/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Informaci贸n Espacial de las 脕reas Naturales Protegidas"
                        },
                        {
                                "FUENTE": "ATLAS NACIONAL DE RIESGOS MX",
                                "Tipo": "KMZ",
                                "ENLACE": "http://atlasnacionalderiesgos.gob.mx/archivo/visor-capas.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "base de datos de los fen贸menos naturales y antr贸picos"
                        },
                        {
                                "FUENTE": "SEMARMAT",
                                "Tipo": "SHP",
                                "ENLACE": "https://gisviewer.semarnat.gob.mx/geointegrador2Beta/index.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Medio Ambiente"
                        },
                        {
                                "FUENTE": "INE",
                                "Tipo": "SHP",
                                "ENLACE": "https://pautas.ine.mx/transparencia/mapas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "coberturas de los medios de radio y televisi贸n,"
                        },
                        {
                                "FUENTE": "CONAGUA",
                                "Tipo": "SHP",
                                "ENLACE": "https://sigagis.conagua.gob.mx/humedales/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Humedales,Sitios Ramsar,Manglares"
                        },
                        {
                                "FUENTE": "AMERIGEO",
                                "Tipo": "SHP",
                                "ENLACE": "https://data.amerigeoss.org/es/dataset?organization=mx&res_format=SHP",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Laderas ,monitoreo de manglares,Divisi贸n pol铆tica"
                        },
                        {
                                "FUENTE": "DATA MX",
                                "Tipo": "SHP",
                                "ENLACE": "https://datamx.io/dataset/bases-geograficas-digitales-ine",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a Basede las 32 entidades estatales"
                        },
                        {
                                "FUENTE": "UNAM",
                                "Tipo": "SHP",
                                "ENLACE": "https://publicaciones.ciga.unam.mx/index.php/ec/catalog/book/38",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa de Paisajes f铆sico-geogr谩ficos de M茅xico: Metadatos, Paisajes, Leyenda, Arbitraje y Mapa Gu铆a (2012)"
                        },
                        {
                                "FUENTE": "VISOR WEB CHIAPAS",
                                "Tipo": "SHP",
                                "ENLACE": "https://map.ceieg.chiapas.gob.mx/geoweb/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Agricultura, ganader铆a, forester铆a y pesca,脕reas naturales protegidas"
                        },
                        {
                                "FUENTE": "VISOR WEB MAP IMT",
                                "Tipo": "SHP",
                                "ENLACE": "http://rnc.imt.mx/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red Nacional de Caminos 2023(Red vial,puentes,estructuras)"
                        },
                        {
                                "FUENTE": "SIGMUN Ciudad Juarez",
                                "Tipo": "SHP",
                                "ENLACE": "https://sigimip.org.mx/descargas.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Infraestructura Urbana"
                        },
                        {
                                "FUENTE": "Geocomunes",
                                "Tipo": "SHP",
                                "ENLACE": "http://132.248.14.102/layers/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "INEGI",
                                "Tipo": "SHP.TIF",
                                "ENLACE": "https://www.inegi.org.mx/temas/hidrografia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "INEGI CENSOS DE POBLACI脫N",
                                "Tipo": "EXCEL",
                                "ENLACE": "https://www.inegi.org.mx/programas/ccpv/2020/",
                                "ENLACE_ORIGINAL": "https://www.inegi.org.mx/programas/ccpv/2020/",
                                "CAPAS": "Subsistema de Informaci贸n Demogr谩fica y Social"
                        },
                        {
                                "FUENTE": "SOLARGIS",
                                "Tipo": "TIF",
                                "ENLACE": "https://solargis.com/es/maps-and-gis-data/download/mexico",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "mapas de recursos solares y datos GIS"
                        },
                        {
                                "FUENTE": "DATOS ABIERTOS-RAN",
                                "Tipo": "SHP",
                                "ENLACE": "https://datos.gob.mx/busca/dataset/datos-geograficos-perimetrales-de-los-nucleos-agrarios-certificados-por-estado--formato-shape",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos geogr谩ficos perimetrales de los n煤cleos agrarios certificados, por estado"
                        },
                        {
                                "FUENTE": "SHAPE DE MEXICO",
                                "Tipo": "SHP-KMZ",
                                "ENLACE": "https://shapesdemexico.wixsite.com/shapes/ran",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Registro Agrario Nacional"
                        },
                        {
                                "FUENTE": "INEGI -HIDROLOG脥A",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.inegi.org.mx/temas/hidrologia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrolog铆a"
                        },
                        {
                                "FUENTE": "IIEG-Jalisco",
                                "Tipo": "SHP",
                                "ENLACE": "https://iieg.gob.mx/biodiversidad/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Biodiversidad de Flora y Fauna Estado Jalisco"
                        },
                        {
                                "FUENTE": "CECORG",
                                "Tipo": "SHP",
                                "ENLACE": "http://www.cec.org/files/atlas/?z=5&x=-100.1953&y=33.6329&lang=es&layers=mareco2&opacities=100&labels=true",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "ATLAS ambiental聽de Am茅rica del Norte"
                        }
                ,
                        {
                                "FUENTE": "AmeriGEOSS - Mexico",
                                "Tipo": "SHP",
                                "ENLACE": "https://data.amerigeoss.org/dataset/?q=mexico&sort=score+desc%2C+metadata_modified+desc",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites administrativos, Datos ambientales, Recursos naturales"
                        },
                        {
                                "FUENTE": "ESOC Princeton - Municipios",
                                "Tipo": ".shp",
                                "ENLACE": "https://esoc.princeton.edu/data/administrative-boundaries-2456-municipalities",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites 2456 municipalidades incluyendo 16 delegaciones CDMX"
                        },
                        {
                                "FUENTE": "IGISMAP - M茅xico",
                                "Tipo": ".shp",
                                "ENLACE": "https://story.mapog.com/app/gisdata/mexico/Mexico%20Country%20Boundary",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites nacionales, estados, carreteras, ferrocarriles, aeropuertos"
                        },
                        {
                                "FUENTE": "SimpleMaps - M茅xico GIS",
                                "Tipo": "SHP,GeoJSON",
                                "ENLACE": "https://simplemaps.com/gis/country/mx",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas nivel nacional y administrativo"
                        },
                        {
                                "FUENTE": "INEGI Red Nacional de Caminos",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.inegi.org.mx/programas/rnc/#descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red vial federal, estatal, municipal y urbana"
                        },
                        {
                                "FUENTE": "IMT Red Nacional de Caminos 2025",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "http://rnc.imt.mx/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red vial por tipo (federal, estatal)"
                        },
                        {
                                "FUENTE": "INEGI Uso de Suelo y Vegetaci贸n",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.inegi.org.mx/temas/usosuelo/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Series V (2015), VII (2021), continuo nacional uso de suelo"
                        },
                        {
                                "FUENTE": "SGM Cartograf铆a Geol贸gica 1:250k",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.datos.gob.mx/dataset/cartografia_geologica_republica_mexicana_escala_1-250-000",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Continuo nacional geolog铆a escala 1:250.000"
                        },
                        {
                                "FUENTE": "Data.gov - Datos M茅xico",
                                "Tipo": "SHP",
                                "ENLACE": "https://catalog.data.gov/dataset?q=mexico&sort=views_recent+desc",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas geol贸gicos, l铆mites internacionales frontera M茅xico"
                        },
                        {
                                "FUENTE": "INEGI Espacio y Datos",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.inegi.org.mx/app/mapa/espacioydatos/default.aspx",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Marcos geoestad铆sticos, v铆as, uso de suelo, censo AGEB, manzanas"
                        }
],
                "total_fuentes": 36
        },
        "Colombia": {
                "coords": [
                        -74.297333,
                        4.570868
                ],
                "flag": "馃嚚馃嚧",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1Fma3O6RbmmUIpD2Z6AZg7ZM1AKBIWvci/edit?gid=366124977#gid=366124977",
                "sheet_id": "1Fma3O6RbmmUIpD2Z6AZg7ZM1AKBIWvci",
                "gid": "366124977",
                "fuentes": [
                        {
                                "FUENTE": "GOV.CO",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.colombiaenmapas.gov.co/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Catastro,Geodesia"
                        },
                        {
                                "FUENTE": "Geoportal DANE",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.dane.gov.co/files/geoportal-provisional/index.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos Geoestad铆ticos"
                        },
                        {
                                "FUENTE": "Sistema de Informaci贸n Ambiental de Colombia - SIAC",
                                "Tipo": ".shp",
                                "ENLACE": "https://siac-datosabiertos-mads.hub.arcgis.com/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "diversas tem脿ticas"
                        },
                        {
                                "FUENTE": "SIAC-MINAMBIENTE",
                                "Tipo": ".shp",
                                "ENLACE": "https://siac-datosabiertos-mads.hub.arcgis.com/search?groupIds=8e6e4bb8ed584377ae7dbe5c9fdaeff4&type=Shapefile",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Humedales,P谩ramos"
                        },
                        {
                                "FUENTE": "Datos abiertos-Instituto SINCHI",
                                "Tipo": ".shp",
                                "ENLACE": "https://datos.siatac.co/pages/monitoreo-ambiental",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Coberturas de suelos,Ordenamiento Territorial"
                        },
                        {
                                "FUENTE": "IDEAM-Dato abiertos",
                                "Tipo": ".shp",
                                "ENLACE": "https://visualizador.ideam.gov.co/CatalogoObjetos/geo-open-data?theme=&group=",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Dato abiertos-Bogot谩",
                                "Tipo": ".shp",
                                "ENLACE": "https://datosabiertos.bogota.gov.co/dataset/localidad-bogota-d-c",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Divisi贸n pol铆tica, administrativa y territorial municipal"
                        },
                        {
                                "FUENTE": "Visor GeoAmbiente Bogot谩",
                                "Tipo": ".shp",
                                "ENLACE": "https://visorgeo.ambientebogota.gov.co/?lon=-74.088180&lat=4.661370&z=11&l=5:1&descargarCapa=119",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Caliad dde Agua,Suelo,Aire"
                        },
                        {
                                "FUENTE": "IDECA",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ideca.gov.co/buscador?topic=All&metadata=All&newest=All&entity=All&resource=All&content_type=map&sort_by=created&sort_order=DESC",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩icas"
                        },
                        {
                                "FUENTE": "INVEMAR-TRIT脫N",
                                "Tipo": ".NC",
                                "ENLACE": "http://triton.invemar.org.co/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Observatorio de los Mares Tropicales de las Am茅ricas"
                        }
                ,
                        {
                                "FUENTE": "Colombia en Mapas (IGAC)",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.colombiaenmapas.gov.co/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "23 tem谩ticas: geolog铆a, l铆mites, minas, infraestructura, ambiente, poblaci贸n, riesgos"
                        },
                        {
                                "FUENTE": "Geoportal DANE",
                                "Tipo": ".shp",
                                "ENLACE": "https://geoportal.dane.gov.co/#gsc.tab=0",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Marcos geoestad铆sticos MGN, DIVIPOLA, departamentos, municipios, veredas, hidrograf铆a"
                        },
                        {
                                "FUENTE": "IGISMAP Colombia",
                                "Tipo": ".shp",
                                "ENLACE": "https://story.mapog.com/app/gisdata/colombia/Municipality%20level%202",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites nacionales, departamentos, municipios, v铆as, aeropuertos"
                        },
                        {
                                "FUENTE": "IGAC Datos Abiertos",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.igac.gov.co/datos-abiertos/datos-abiertos-geoespaciales",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Estudios de suelos 1:100k, capacidad de uso, vocaci贸n de tierras"
                        },
                        {
                                "FUENTE": "ICDE Geoservicios",
                                "Tipo": "WMS,SHP",
                                "ENLACE": "https://www.icde.gov.co/geovisor/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Coberturas y usos de tierra, suelos regionales"
                        },
                        {
                                "FUENTE": "Servicio Geol贸gico Colombiano",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://srvags.sgc.gov.co/PortalWeb/Elementos-web/Geoportal/prueba/index.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Geolog铆a b谩sica, fallas, litolog铆a"
                        },
                        {
                                "FUENTE": "IDEAM Geoportal",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://experience.arcgis.com/experience/568ddab184334f6b81a04d2fe9aac262/page/Geoportal-Institucional/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Clima, isoyetas nacionales, temperatura, precipitaci贸n"
                        },
                        {
                                "FUENTE": "SIAC Recursos Ambientales",
                                "Tipo": "SHP",
                                "ENLACE": "http://archivo.siac.gov.co/web/siac2/recursos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Recursos ambientales nacionales"
                        },
                        {
                                "FUENTE": "CVC Valle del Cauca",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geo.cvc.gov.co/arcgis/rest/services",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Temperatura, isotermas, pisos t茅rmicos, provincia humedad regional"
                        },
                        {
                                "FUENTE": "GeoBoundaries Colombia",
                                "Tipo": "SHP,GeoJSON",
                                "ENLACE": "https://www.geoboundaries.org/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites subnacionales ADM0-ADM3, Poblaci贸n"
                        }
],
                "total_fuentes": 20
        },
        "Ecuador": {
                "coords": [
                        -78.183406,
                        -1.831239
                ],
                "flag": "馃嚜馃嚚",
                "google_sheet": "https://docs.google.com/spreadsheets/d/14ifebvTD78zh2XXLnpcmDpqttHZvD-k9/edit?gid=1653672626#gid=1653672626",
                "sheet_id": "14ifebvTD78zh2XXLnpcmDpqttHZvD-k9",
                "gid": "1653672626",
                "fuentes": [
                        {
                                "FUENTE": "IGM",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/portal/index.php/descargas/cartografia-de-libre-acceso/registro/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Geoportal IGM",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/geoinformacion/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a Base,Informci贸n tem谩tica"
                        },
                        {
                                "FUENTE": "gis.uazuay.edu.ec",
                                "Tipo": ".shp",
                                "ENLACE": "https://gis.uazuay.edu.ec/descargas/promsa/ecuador.htm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Limites administrativos"
                        },
                        {
                                "FUENTE": "GEOPORTAL IGM",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/portal/index.php/cartografia-de-libre-acceso-escala-50k/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "CARTAS TOPOGR脕FICAS ESCALA 1:50.000"
                        },
                        {
                                "FUENTE": "INEC",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ecuadorencifras.gob.ec/documentos/web-inec/Geografia_Estadistica/Micrositio_geoportal/index.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Divisi贸n pol铆tica administrativa"
                        },
                        {
                                "FUENTE": "MAPBIOMAS EC",
                                "Tipo": ".shp",
                                "ENLACE": "https://plataforma.ecuador.mapbiomas.org/cobertura?activeBaseMap=9&layersOpacity=100&activeModule=coverage&activeModuleContent=coverage%3Acoverage_main&activeYear=2022&mapPosition=-3.125432%2C-82.017059%2C9&timelineLimitsRange=1985%2C2022&baseParams%5bterritoryType%5d=1&baseParams%5bterritories%5d=1%3BEcuador%3B1%3BPa%C3%ADs%3B0%3B0%3B0%3B0&baseParams%5bactiveClassTreeOptionValue%5d=default&baseParams%5bactiveClassTreeNodeIds%5d=7%2C13%2C14%2C15%2C16%2C8%2C17%2C18%2C19%2C20%2C9%2C21%2C22%2C10%2C23%2C24%2C11%2C25%2C26%2C27%2C12&baseParams%5bactiveSubmodule%5d=coverage_main&baseParams%5byearRange%5d=1985-2022",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "脕reas naturales protegidas,Sitios RAMSAR,Ecositemas"
                        },
                        {
                                "FUENTE": "CIUQ EC",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ciuq.ec/descargas/descargas.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "RAISG",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.raisg.org/es/mapas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas-SE NECESITA REGISTRASE PARA LA DESCARGA"
                        },
                        {
                                "FUENTE": "Geoportal IGM- VISOR AFC",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/pag_afc/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Aptitud f铆sica del territorio"
                        },
                        {
                                "FUENTE": "IGM-Aptitud f铆sica del territorio",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/geoinformacion/index-alt7.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Aptitud f铆sica del territorio"
                        },
                        {
                                "FUENTE": "SolarGIS",
                                "Tipo": "tif",
                                "ENLACE": "https://solargis.com/es/resources/free-maps-and-gis-data?locality=ecuador",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas solares"
                        },
                        {
                                "FUENTE": "gis.uazuay.edu.ec",
                                "Tipo": ".shp",
                                "ENLACE": "https://gis.uazuay.edu.ec/descargas/promsa/sur_america/home.htm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Informaci贸n Espacial de Sur Am茅rica"
                        },
                        {
                                "FUENTE": "Instituto de Investigaci贸n Geol贸gico y Energ茅tico",
                                "Tipo": "pdf",
                                "ENLACE": "https://www.geoenergia.gob.ec/mapas-tematicos-1-100-000/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartas geologicas escala 100000"
                        }
                ,
                        {
                                "FUENTE": "Geoportal IGM Ecuador",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.geoportaligm.gob.ec",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a base nacional, l铆mites administrativos"
                        },
                        {
                                "FUENTE": "INEC Geoportal",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.ecuadorencifras.gob.ec/documentos/web-inec/Geografia_Estadistica/Micrositio_geoportal/index.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Estad铆sticas georreferenciadas, censos, poblaci贸n"
                        },
                        {
                                "FUENTE": "GeoEnerg铆a Mapas Geol贸gicos",
                                "Tipo": "SHP,PDF",
                                "ENLACE": "https://www.geoenergia.gob.ec/mapas-geologicos/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas geol贸gicos nacionales"
                        },
                        {
                                "FUENTE": "IGM Cartograf铆a Libre 50k",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportaligm.gob.ec/portal/index.php/cartografia-de-libre-acceso-escala-50k/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Capas informaci贸n geogr谩fica b谩sica libre acceso"
                        },
                        {
                                "FUENTE": "IDE Ambiente Ecuador",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "http://ide.ambiente.gob.ec/mapainteractivo/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "脕reas protegidas, ecosistemas, biodiversidad ambiental"
                        },
                        {
                                "FUENTE": "MapBiomas Ecuador",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://ecuador.mapbiomas.org/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Ecorregiones/biomas, cobertura vegetal, 37 clases uso suelo"
                        }
],
                "total_fuentes": 19
        },
        "Brasil": {
                "coords": [
                        -47.882166,
                        -15.793889
                ],
                "flag": "馃嚙馃嚪",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1R0KTKVBHNsay6W9ml-UMo2MXphgbaXyW/edit?gid=1130141603#gid=1130141603",
                "sheet_id": "1R0KTKVBHNsay6W9ml-UMo2MXphgbaXyW",
                "gid": "1130141603",
                "fuentes": [
                        {
                                "FUENTE": "Instituto Brasileiro de Geografia e Estat铆stica-IBGE",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ibge.gov.br/geociencias/organizacao-do-territorio/malhas-territoriais/26565-malhas-de-setores-censitarios-divisoes-intramunicipais.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Malha de Setores Censit谩rios"
                        },
                        {
                                "FUENTE": "N煤cleo de Economia Regional e Urbana da USP 鈥?NEREUS",
                                "Tipo": ".shp",
                                "ENLACE": "http://www.usp.br/nereus/?dados=brasil",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Regi玫es Geogr谩ficas,Unidades,Federativas,Mesorregi玫es,Microrregi玫es,Munic铆pios"
                        },
                        {
                                "FUENTE": "GEOAPLICADA",
                                "Tipo": ".shp,TIF",
                                "ENLACE": "https://www.geoaplicada.com/dados-espaciais/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas Tem谩ticas"
                        },
                        {
                                "FUENTE": "Portal de mapas IBGE",
                                "Tipo": ".shp",
                                "ENLACE": "https://portaldemapas.ibge.gov.br/portal.php",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas Tem谩ticas"
                        },
                        {
                                "FUENTE": "GEOMAPS ANP",
                                "Tipo": ".shp",
                                "ENLACE": "https://geomaps.anp.gov.br/geoanp/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Gasoductos,Pozos"
                        },
                        {
                                "FUENTE": "TerraBasiliis",
                                "Tipo": ".shp",
                                "ENLACE": "https://terrabrasilis.dpi.inpe.br/downloads/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Biomas"
                        },
                        {
                                "FUENTE": "GEOPORTAL-TerraBasiliis",
                                "Tipo": ".shp",
                                "ENLACE": "https://terrabrasilis.dpi.inpe.br/app/map/vegetation?hl=pt-br",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Tipos de Vegeta莽茫o no Bioma"
                        },
                        {
                                "FUENTE": "GOV.BR-Minist茅rio dos Transportes",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.gov.br/transportes/pt-br/assuntos/dados-de-transportes/bit/bit-mapas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "mapas multimodales nacionales, estatales y de modos de transporte."
                        },
                        {
                                "FUENTE": "MAPBIOMAS-BRASIL",
                                "Tipo": ".shp",
                                "ENLACE": "https://brasil.mapbiomas.org/dados-de-infraestrutura/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "carreteras federales, centrales hidroel茅ctricas)"
                        },
                        {
                                "FUENTE": "Webmap EPE",
                                "Tipo": ".shp",
                                "ENLACE": "https://gisepeprd2.epe.gov.br/WebMapEPE/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Sistema de Informa莽玫es Geogr谩ficas do Setor Energ茅tico Brasileiro"
                        },
                        {
                                "FUENTE": "SIMRPPN",
                                "Tipo": ".shp",
                                "ENLACE": "https://sistemas.icmbio.gov.br/simrppn/publico/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "RESERVAS PARTICULARES DO PATRIM脭NIO NATURAL - RPPN"
                        },
                        {
                                "FUENTE": "Laboratorio de Econom铆a Regional y Urbana de la Universidad de Sao Paulo 鈥?NEREUS",
                                "Tipo": ".shp",
                                "ENLACE": "http://www.usp.br/nereus/?dados=unidades-federativas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Unidades Federativas"
                        },
                        {
                                "FUENTE": "IPPUC",
                                "Tipo": ".shp",
                                "ENLACE": "https://ippuc.org.br/geodownloads/geo.htm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "ARRUAMENTO,ALTIMETRIA,CADASTRO T脡CNICO,EQUIPAMENTOS URBANOS"
                        },
                        {
                                "FUENTE": "Diretoria de Hidrografia e Navega莽茫o Marinha do Brasil",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.marinha.mil.br/dhn/?q=node/169",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Limites Mar铆timos e LEPLAC"
                        },
                        {
                                "FUENTE": "Mapa digital de la ciudad de Sao Paulo",
                                "Tipo": ".shp",
                                "ENLACE": "https://geosampa.prefeitura.sp.gov.br/PaginasPublicas/_SBC.aspx",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas Tem谩ticas"
                        },
                        {
                                "FUENTE": "IPHAN",
                                "Tipo": ".shp",
                                "ENLACE": "http://portal.iphan.gov.br/pagina/detalhes/1701/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Bancos de Dados - Patrim么nio Arqueol贸gico"
                        },
                        {
                                "FUENTE": "Alto Tiete",
                                "Tipo": ".shp",
                                "ENLACE": "https://comiteat.sp.gov.br/a-bacia/shapefiles/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": ""
                        },
                        {
                                "FUENTE": "DataGeo-Sistema Ambiental Paulista",
                                "Tipo": ".shp",
                                "ENLACE": "http://datageo.ambiente.sp.gov.br/app/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Sistema Ambiental de So Paulo"
                        },
                        {
                                "FUENTE": "Prefeitura de S茫o Paulo",
                                "Tipo": ".shp",
                                "ENLACE": "http://dados.prefeitura.sp.gov.br/dataset?res_format=SHP",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos Abiertos de  S茫o Paulo"
                        },
                        {
                                "FUENTE": "LABCIDADE",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.labcidade.fau.usp.br/dadosabertos/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "arquitetura e urbanismo, direito, geografia, ci锚ncias sociais,"
                        }
                ,
                        {
                                "FUENTE": "IBGE Limites Administrativos",
                                "Tipo": ".shp",
                                "ENLACE": "https://geoftp.ibge.gov.br/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Estados, municipios, mesorregiones, microrregiones, divisiones urbano-regional"
                        },
                        {
                                "FUENTE": "MapBiomas Brasil",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://brasil.mapbiomas.org/downloads/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura vegetal anual, deforestaci贸n, uso de suelo"
                        },
                        {
                                "FUENTE": "ANA Base Hidrogr谩fica SNIRH",
                                "Tipo": "SHP",
                                "ENLACE": "https://metadados.snirh.gov.br/geonetwork",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red hidrogr谩fica nacional, masas de agua"
                        },
                        {
                                "FUENTE": "IBGE Bacias Hidrogr谩ficas",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ibge.gov.br/geociencias/cartas-e-mapas/informacoes-ambientais/31653-bacias-e-divisoes-hidrograficas-do-brasil.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cuencas y divisiones hidrogr谩ficas de Brasil"
                        },
                        {
                                "FUENTE": "GeoSGB CPRM Geolog铆a",
                                "Tipo": ".shp",
                                "ENLACE": "https://geosgb.sgb.gov.br/geosgb/downloads.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geol贸gico 1:2.5M, ~500 formaciones, unidades geol贸gicas"
                        },
                        {
                                "FUENTE": "IBGE Geomorfolog铆a",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ibge.gov.br/geociencias/informacoes-ambientais/geomorfologia/10870-geomorfologia.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Geomorfolog铆a nacional"
                        },
                        {
                                "FUENTE": "MMA Unidades de Conserva莽茫o",
                                "Tipo": ".shp",
                                "ENLACE": "https://dados.mma.gov.br/dataset/unidadesdeconservacao",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "脕reas protegidas nacionales pol铆gono 2025, CNUC"
                        },
                        {
                                "FUENTE": "ANA Dados Abertos Massas d'脕gua",
                                "Tipo": "SHP",
                                "ENLACE": "https://dadosabertos.ana.gov.br/datasets/4c606c38ee534b84bffe70ca6c8552c6_0/about",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Masas de agua nacionales"
                        }
],
                "total_fuentes": 28
        },
        "Argentina": {
                "coords": [
                        -63.616672,
                        -38.416097
                ],
                "flag": "馃嚘馃嚪",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1Ihb3uXX6aweaUBUeWRdsqwcJ7DIiQITQ/edit?gid=1073350435#gid=1073350435",
                "sheet_id": "1Ihb3uXX6aweaUBUeWRdsqwcJ7DIiQITQ",
                "gid": "1073350435",
                "fuentes": [
                        {
                                "FUENTE": "Datasets",
                                "Tipo": ".shp",
                                "ENLACE": "https://datos.gob.ar/dataset?tags=Informaci%C3%B3n+Geogr%C3%A1fica",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "GIS DATA MAP",
                                "Tipo": ".shp",
                                "ENLACE": "https://gisdata.mapog.com/argentina/Argentina Country Boundary",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "l铆mites administrativos de Argentina: provincias, departamentos, municipios"
                        },
                        {
                                "FUENTE": "Sistema Unificado de Informaci贸n Energ茅tica",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.argentina.gob.ar/economia/energia/planeamiento-energetico/informacion-energetica/sistema-unificado-de-informacion-2",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Exploraci贸n y Producci贸n de Hidrocarburos"
                        },
                        {
                                "FUENTE": "Repositorio Institucional CONICET Digital",
                                "Tipo": ".shp",
                                "ENLACE": "https://ri.conicet.gov.ar/handle/11336/149867",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Base cartogr谩fica de departamentos para los censos nacionales de la Rep煤blica Argentina desde 1869 a 2010"
                        },
                        {
                                "FUENTE": "INDEC",
                                "Tipo": ".shp",
                                "ENLACE": "https://viascirculacion.indec.gob.ar/?contenido=descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "informaci贸n de las v铆as de circulaci贸n"
                        },
                        {
                                "FUENTE": "Infraestructura de Datos Espaciales de la Provincia de C贸rdoba- IDECOR",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.mapascordoba.gob.ar/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Buenos Aire DATA-BADATA",
                                "Tipo": ".shp",
                                "ENLACE": "https://data.buenosaires.gob.ar/dataset/cuarteles-destacamentos-bomberos/resource/juqdkmgo-672-resource",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cuarteles y Destacamentos de Bomberos de Polic铆a Federal Argentina"
                        },
                        {
                                "FUENTE": "Gobierno de la Provincia de Buenos Aires",
                                "Tipo": ".shp",
                                "ENLACE": "https://catalogo.datos.gba.gob.ar/dataset?groups=cultura-",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Santa Fe",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.santafe.gov.ar/ipecinformes/plantasurbanas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Plantas Urbanas"
                        },
                        {
                                "FUENTE": "AGENCIA DE RECAUDACI脫N-PROVINCIA DE BUENOS AIRES",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.arba.gov.ar/geoarba/inicio.asp",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Objetos catastrales por partido (o departamento"
                        }
                ,
                        {
                                "FUENTE": "IGN Capas SIG",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ign.gob.ar/NuestrasActividades/InformacionGeoespacial/CapasSIG",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites provincias/municipios, redes viales/hidrogr谩ficas, relieve, toponimia"
                        },
                        {
                                "FUENTE": "GeoPortal IGN",
                                "Tipo": "WFS,WMS,SHP",
                                "ENLACE": "https://geoportal.ign.gob.ar",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Visor INSPIRE exportable a shapefile: l铆mites, infraestructuras"
                        },
                        {
                                "FUENTE": "INTA Digital GEO",
                                "Tipo": "SHP",
                                "ENLACE": "https://geo.inta.gob.ar",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Suelos cartas 1:50k, agua/clima, vegetaci贸n/ganader铆a, riesgos"
                        },
                        {
                                "FUENTE": "datos.gob.ar Unidades Territoriales",
                                "Tipo": "SHP",
                                "ENLACE": "https://datos.gob.ar/dataset/ign-unidades-territoriales/archivo/ign_01.04.02",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Municipios/comunas IGN, provincias, 谩reas protegidas"
                        },
                        {
                                "FUENTE": "datos.gob.ar Rutas Nacionales",
                                "Tipo": "SHP,GeoJSON,KML",
                                "ENLACE": "https://datos.gob.ar/dataset/transporte-rutas-nacionales/archivo/transporte_d58b91ee-c46a-4260-8d89-69438417d73b",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Rutas nacionales DNV"
                        },
                        {
                                "FUENTE": "INDEC V铆as Circulaci贸n",
                                "Tipo": "SHP,CSV,WMS",
                                "ENLACE": "https://viascirculacion.indec.gob.ar/?contenido=descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "V铆as por provincia"
                        },
                        {
                                "FUENTE": "SEGEMAR SIGAM",
                                "Tipo": "SHP",
                                "ENLACE": "https://sigam.segemar.gov.ar/wordpress/catalogo-de-metadatos-2/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geol贸gico Nacional 1:2.5M, cartas 1:250k, fallas, litolog铆a"
                        },
                        {
                                "FUENTE": "Geoportal IDESA",
                                "Tipo": "SHP,GeoTIFF",
                                "ENLACE": "http://geoportal.idesa.gob.ar/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos abiertos federales: biodiversidad, riesgos"
                        },
                        {
                                "FUENTE": "MapBiomas Argentina",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://argentina.mapbiomas.org/mapas-de-referencia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura/uso suelo 1985-2024, vegetaci贸n nativa, bosque, ecorregiones"
                        },
                        {
                                "FUENTE": "SIB Ecorregiones Argentina",
                                "Tipo": "SHP,CSV",
                                "ENLACE": "https://sib.gob.ar/ecorregiones",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "18 ecorregiones, especies mam铆feros/aves/plantas, 谩reas protegidas"
                        },
                        {
                                "FUENTE": "SMN Datos Abiertos",
                                "Tipo": "SHP,CSV",
                                "ENLACE": "https://www.smn.gob.ar/descarga-de-datos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Series pluviom茅tricas >1.000 estaciones, isoyetas hist贸ricas"
                        },
                        {
                                "FUENTE": "CONAE Geoportal",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geoportal.conae.gov.ar/mapstore/#/viewer/openlayers/geoportal",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Im谩genes satelitales, datos espaciales"
                        },
                        {
                                "FUENTE": "IGN Mapa Cobertura Suelo 2021",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://github.com/ign-argentina/mapa-nacional-cobertura-suelo",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "13 categor铆as: agricultura, bosque nativo/implantado, pastizal, humedales, urbano"
                        },
                        {
                                "FUENTE": "IDERA",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.idera.gob.ar/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Infraestructura de datos espaciales federal"
                        }
],
                "total_fuentes": 24
        },
        "Espa帽a": {
                "coords": [
                        -3.70379,
                        40.416775
                ],
                "flag": "馃嚜馃嚫",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1Es2jSlHi9vXcm2imrfcj535PlSjQPXUR/edit?gid=15558773#gid=15558773",
                "sheet_id": "1Es2jSlHi9vXcm2imrfcj535PlSjQPXUR",
                "gid": "15558773",
                "fuentes": [
                        {
                                "FUENTE": "Centro de descargas Organismo Aut贸nomo Centro Nacional de Informaci贸n Geogr谩fica (CNIG)",
                                "Tipo": ".shp",
                                "ENLACE": "http://centrodedescargas.cnig.es/CentroDescargas/index.jsp",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos topogr谩ficos b谩sicos necesarios para la representaci贸n del territorio."
                        },
                        {
                                "FUENTE": "Datis Es",
                                "Tipo": ".shp",
                                "ENLACE": "http://datos.gob.es/",
                                "ENLACE_ORIGINAL": "Datos.gob.es",
                                "CAPAS": "Variado"
                        },
                        {
                                "FUENTE": "IDEE-Centro de Descargas",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.idee.es/web/idee/centros-de-descarga/estatal",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": ""
                        },
                        {
                                "FUENTE": "MITECO",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.miteco.gob.es/es/cartografia-y-sig/ide/descargas/reto-demografico/datos-demograficos.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos Demogr谩ficos"
                        },
                        {
                                "FUENTE": "Portal de Datos Abiertos de Esri Espa帽a",
                                "Tipo": ".shp",
                                "ENLACE": "https://opendata.esri.es/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Variado"
                        },
                        {
                                "FUENTE": "OPEN DATA ESRI ESPA脩A",
                                "Tipo": ".shp",
                                "ENLACE": "https://opendata.esri.es/datasets/53229f5912e04f1ba6dddb70a5abeb72/explore",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mnucipios IGN"
                        },
                        {
                                "FUENTE": "Ministerio de Agricultura ,pesca y alimentaci贸n",
                                "Tipo": ".shp,.tiff",
                                "ENLACE": "https://www.mapa.gob.es/es/cartografia-y-sig/ide/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Agricultura,ganader铆a,alimentaci贸n"
                        },
                        {
                                "FUENTE": "Descarga de la informaci贸n de los Datos Espaciales de Referencia de Andaluc铆a (DERA)",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.juntadeandalucia.es/institutodeestadisticaycartografia/dega/datos-espaciales-de-referencia-de-andalucia-dera/descarga-de-informacion",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Relieve,Hidrografia,medio ambiente"
                        },
                        {
                                "FUENTE": "Ministerio de Transporte y Movilidad Sostennible",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.transportes.gob.es/carreteras/catalogo-y-evolucion-de-la-red-de-carreteras",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "red de carreteras"
                        },
                        {
                                "FUENTE": "Sistema de Informaci贸n Territorial de Extramadura-SITEX",
                                "Tipo": ".shp",
                                "ENLACE": "http://sitex.gobex.es/SITEX/centrodescargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Topograf铆a, estudios territoriales,Ortofotos"
                        },
                        {
                                "FUENTE": "Infraestructura de Datos Espaciales de Castilla y Le贸n",
                                "Tipo": ".shp",
                                "ENLACE": "https://cartografia.jcyl.es/web/es/datos-servicios/servicio-descargas.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Topograf铆a,Ortofotos,Ocupac贸n del suelo"
                        },
                        {
                                "FUENTE": "Miterd",
                                "Tipo": ".shp,kmz",
                                "ENLACE": "https://www.miteco.gob.es/es/agua/servicios/acceso-rapido-datos-agua.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrologia,demarcaciones hidrofr谩ficas"
                        },
                        {
                                "FUENTE": "Cat谩logo de Informaci贸n Geogr谩fica de la Comunidad de Madrid",
                                "Tipo": ".shp",
                                "ENLACE": "https://idem.comunidad.madrid/catalogocartografia/srv/spa/catalog.search;jsessionid=E01EDFBE2F14887C7E7627BC70907545.p13423306",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrograf铆a,biotopos,recursos energ茅ticos"
                        },
                        {
                                "FUENTE": "DEMs ESPA脩A  Mart铆n Gonz谩lez.",
                                "Tipo": ".TIF",
                                "ENLACE": "https://martingonzalez.net/ign-dem-grabber/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "DEM"
                        },
                        {
                                "FUENTE": "Confederaci贸n Hidrogr谩fica del Segura, O.A.",
                                "Tipo": "shp",
                                "ENLACE": "https://www.chsegura.es/es/cuenca/cartografia/descarga-de-cartografia-en-formato-shp/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red hidrogr谩fica,Acuiferos,limite de cuenca"
                        },
                        {
                                "FUENTE": "IGN",
                                "Tipo": "shp",
                                "ENLACE": "http://www.ign.es/web/ign/portal/cbg-area-cartografia",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a y Datos geogr谩ficos"
                        },
                        {
                                "FUENTE": "ESI ESPA脩A",
                                "Tipo": "shp",
                                "ENLACE": "https://opendata.esri.es/datasets/68745a7fb7a348b6b0d722c8517790af/explore",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hospitales"
                        },
                        {
                                "FUENTE": "Consorcio Madro帽o",
                                "Tipo": "shp",
                                "ENLACE": "https://edatos.consorciomadrono.es/dataset.xhtml?persistentId=doi:10.21950/0098O1",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Vulnerabilidad urbana, Barrios vulnerables,"
                        },
                        {
                                "FUENTE": "Mapa Forestal de Espa帽a (MFE)",
                                "Tipo": "shp",
                                "ENLACE": "https://www.miteco.gob.es/es/cartografia-y-sig/ide/descargas/biodiversidad/mfe.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Forestal de Espa帽a"
                        },
                        {
                                "FUENTE": "Cat谩logo de datos del IEO",
                                "Tipo": "shp",
                                "ENLACE": "http://datos.ieo.es/geonetwork/srv/search?category=Capas%20SIG",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Capas SIG"
                        },
                        {
                                "FUENTE": "Datos Comunidad de Madrid",
                                "Tipo": "shp",
                                "ENLACE": "https://datos.comunidad.madrid/catalogo/dataset/spacmsiose2011/resource/041d80ab-1701-4ea0-9226-9a1e8c00fa09",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Sistema de Informaci贸n de Ocupaci贸n del Suelo"
                        }
                ,
                        {
                                "FUENTE": "CNIG L铆mites Administrativos",
                                "Tipo": ".shp",
                                "ENLACE": "https://centrodedescargas.cnig.es/CentroDescargas/limites-municipales-provinciales-autonomicos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites municipales, provinciales, auton贸micos (BDDAE)"
                        },
                        {
                                "FUENTE": "CNIG Centro de Descargas",
                                "Tipo": "SHP,GDB,GeoPDF",
                                "ENLACE": "https://centrodedescargas.cnig.es/CentroDescargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": ">100 capas: transporte, hidrograf铆a, CORINE Land Cover, SIOSE, Atlas Nacional"
                        },
                        {
                                "FUENTE": "IDEE Geoportal INSPIRE",
                                "Tipo": "WMS,WFS,SHP",
                                "ENLACE": "https://www.idee.es",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites, topograf铆a, hidrograf铆a, transporte, ortofotos INSPIRE"
                        },
                        {
                                "FUENTE": "SIOSE Uso de Suelo",
                                "Tipo": "SHP,PostGIS",
                                "ENLACE": "https://www.siose.es/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Ocupaci贸n suelo 1:25k, 25 clases principales 2005-2020"
                        },
                        {
                                "FUENTE": "IGME MAGNA 1:50.000",
                                "Tipo": ".shp",
                                "ENLACE": "https://info.igme.es/cartografiadigital/geologica/Magna50.aspx",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geol贸gico Nacional >800 hojas, unidades litol贸gicas, fallas"
                        },
                        {
                                "FUENTE": "CNIG Hidrograf铆a IGR",
                                "Tipo": ".shp",
                                "ENLACE": "https://centrodedescargas.cnig.es/CentroDescargas/hidrografia",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "R铆os, canales, lagos, embalses, presas, red hidrol贸gica BTN25 LiDAR"
                        },
                        {
                                "FUENTE": "CNIG Redes de Transporte",
                                "Tipo": ".shp",
                                "ENLACE": "https://centrodedescargas.cnig.es/CentroDescargas/redes-transporte",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "52 shapefiles provinciales carreteras + 6 nacionales interurbanas"
                        },
                        {
                                "FUENTE": "CORINE Land Cover CLC 2018",
                                "Tipo": ".shp",
                                "ENLACE": "https://datos.gob.es/es/catalogo/e00125901-spaignclc2018",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "44 clases europeas urbanos, agr铆colas, forestales 1:100k ETRS89"
                        },
                        {
                                "FUENTE": "Catastro Espa帽a",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.catastro.hacienda.gob.es/ayuda/ayuda_descarga_shape.htm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Parcelas, recintos, pol铆gonos, usos r煤stico/urbano por municipio"
                        },
                        {
                                "FUENTE": "MITECO Biodiversidad",
                                "Tipo": "SHP,INSPIRE",
                                "ENLACE": "https://www.miteco.gob.es/es/cartografia-y-sig/ide/descargas/biodiversidad.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "H谩bitats, especies prioritarias, 谩reas protegidas ZEPA/ZEC/LIC"
                        },
                        {
                                "FUENTE": "MFE50 Mapa Forestal Espa帽a",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.miteco.gob.es/es/biodiversidad/servicios/banco-datos-naturaleza/informacion-disponible/mfe50_descargas_ccaa.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Ecosistemas forestales 1:50k, >5.500 especies, por provincia"
                        },
                        {
                                "FUENTE": "AEMET Atlas Clim谩tico",
                                "Tipo": "TIFF,SHP",
                                "ENLACE": "https://www.aemet.es/es/serviciosclimaticos/datosclimatologicos/atlas_climatico",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Normales 1981-2010 precipitaci贸n, temperatura, mapas georreferenciados"
                        },
                        {
                                "FUENTE": "GEAMAP Visor Geol贸gico",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geamap.com/es/geologico-espana",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Geolog铆a nacional 1M, m谩rgenes continentales, volcanes submarinos"
                        },
                        {
                                "FUENTE": "ANE Atlas Nacional - Clima",
                                "Tipo": ".shp",
                                "ENLACE": "https://centrodedescargas.cnig.es/CentroDescargas/informacion-geografica-tematica",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Precipitaci贸n media anual, temperatura, evaporaci贸n, pisos t茅rmicos 1:3M"
                        },
                        {
                                "FUENTE": "MITECO Red Hidrogr谩fica",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.miteco.gob.es/es/cartografia-y-sig/ide/descargas/agua/red-hidrografica.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red hidrogr谩fica principal Espa帽a"
                        },
                        {
                                "FUENTE": "MITMA Red Carreteras Estado",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.transportes.gob.es/carreteras/catalogo-y-evolucion-de-la-red-de-carreteras/archivos-geometrias-rce",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Tramos RCE calibrados, carreteras estado"
                        },
                        {
                                "FUENTE": "SIGPAC Parcelas Agrarias",
                                "Tipo": ".shp",
                                "ENLACE": "https://sigpac.mapa.es/fega/visor/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Parcelas agrarias con usos/cultivos por provincia/municipio"
                        },
                        {
                                "FUENTE": "MITECO Datos Abiertos",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.datosabiertos.miteco.gob.es/es.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos geoespaciales abiertos medio ambiente"
                        }
],
                "total_fuentes": 39
        },
        "Chile": {
                "coords": [
                        -71.542969,
                        -35.675147
                ],
                "flag": "馃嚚馃嚤",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1eYqfLvxgFqzn8QYJo-0uf0b4w2pp-IIe/edit?gid=1229221294#gid=1229221294",
                "sheet_id": "1eYqfLvxgFqzn8QYJo-0uf0b4w2pp-IIe",
                "gid": "1229221294",
                "fuentes": [
                        {
                                "FUENTE": "Instituto Nacional de Estad铆tica",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.ine.gob.cl/herramientas/portal-de-mapas/geodatos-abiertos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Censo,din谩mica territorial"
                        },
                        {
                                "FUENTE": "Biblioteca del congreo Nacional-BCN",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.bcn.cl/siit/mapas_vectoriales",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "IDE Institucionales",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportal.cl/catalog",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "IDE Minvu",
                                "Tipo": ".shp",
                                "ENLACE": "https://ide.minvu.cl/search?groupIds=bfcdf69a6f224070a3c9a3ec024960d9",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "MINAGRI",
                                "Tipo": ".shp",
                                "ENLACE": "https://ide.minagri.gob.cl/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "CATASTRO DE USO DE SUELO Y VEGATACI脫N ,MONITOREOS DE CAMBIOS DE USOS DE LA TIERRA (CONAF)"
                        },
                        {
                                "FUENTE": "Geoportal de Chile",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportal.cl/geoportal/catalog/36391/Divisi%C3%B3n Pol%C3%ADtica Administrativa 2023",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Divisi贸n Pol铆tica Administrativa 2023"
                        },
                        {
                                "FUENTE": "Consejos de Monumentos Nacionales CMN",
                                "Tipo": ".shp,KMZ",
                                "ENLACE": "https://geoportalcmn.maps.arcgis.com/apps/webappviewer/index.html?id=3da2942d97f34bee94c841d42c431f2a",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Monumentos Nacionales"
                        },
                        {
                                "FUENTE": "Visor de Potencialidad Paleontol贸gica",
                                "Tipo": ".shp",
                                "ENLACE": "https://experience.arcgis.com/experience/530884c789b94d85a92554eb52975255/page/COQUIMBO/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Potencialidad Paleontol贸gica"
                        },
                        {
                                "FUENTE": "Plataforma datos abiertos LBP",
                                "Tipo": ".shp",
                                "ENLACE": "https://lineasdebasepublicas.mma.gob.cl/datos_abiertos/dataset/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "IDE Patrimonio",
                                "Tipo": ".shp",
                                "ENLACE": "https://ide.patrimoniocultural.gob.cl/es/centro_descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Descarga de Capas del Patrimonio Cultural"
                        },
                        {
                                "FUENTE": "CONAF",
                                "Tipo": ".shp",
                                "ENLACE": "https://sit.conaf.cl/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Catastro de Usos de la Tierra y Recursos Vegetacionales"
                        },
                        {
                                "FUENTE": "Subsecretar铆a de Telecomunicaciones",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.subtel.gob.cl/archivos-shape/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "telecomunicaciones"
                        }
                ,
                        {
                                "FUENTE": "IDE Chile Geoportal",
                                "Tipo": "SHP,GML,WFS",
                                "ENLACE": "https://geoportal.cl/catalog",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": ">10 categor铆as: l铆mites DPA 2023, transporte, salud, medio ambiente, oc茅anos"
                        },
                        {
                                "FUENTE": "IGM Descargas Gratuitas",
                                "Tipo": "SHP,KMZ",
                                "ENLACE": "https://www.igm.cl/?page=descargas-gratuitas-igm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas mudos Chile, grillas UTM, l铆mites internacionales DIFROL 1:50k"
                        },
                        {
                                "FUENTE": "BCN Mapas Vectoriales",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.bcn.cl/siit/mapas_vectoriales/index_html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a hist贸rica/actual, l铆mites, topograf铆a"
                        },
                        {
                                "FUENTE": "INE Geodatos Abiertos",
                                "Tipo": ".shp",
                                "ENLACE": "http://www.ine.gob.cl/herramientas/portal-de-mapas/geodatos-abiertos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos censales, poblaci贸n, l铆mites comunales"
                        },
                        {
                                "FUENTE": "MOP Red Vial Nacional",
                                "Tipo": ".shp",
                                "ENLACE": "https://mapas.mop.gov.cl/red-vial/Red_Vial_Chile.zip",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red vial segmentada: carreteras, caminos b谩sicos, terciarios SIRGAS"
                        },
                        {
                                "FUENTE": "IDE Chile Hidrograf铆a",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geoportal.cl/geoportal/catalog/download/e109bc13-483e-3452-b918-2456cbc3db74",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Red hidrogr谩fica 1:25k Arica-O'Higgins, r铆os, quebradas, canales"
                        },
                        {
                                "FUENTE": "DGA Cuencas BNA",
                                "Tipo": ".shp",
                                "ENLACE": "https://dga.mop.gob.cl/uploads/sites/13/2024/07/Cuencas_BNA.zip",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "104 cuencas principales (Biob铆o, Maipo, Limar铆), subcuencas ~400"
                        },
                        {
                                "FUENTE": "Sernageomin Portal GEOMIN",
                                "Tipo": "SHP,GDB",
                                "ENLACE": "https://www.sernageomin.cl/visores-mineros/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geol贸gico Nacional 1:1M, cartas geol贸gicas serie b谩sica"
                        },
                        {
                                "FUENTE": "SIMBIO MMA Biodiversidad",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://simbio.mma.gob.cl",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "SNAP: 42 parques, 48 reservas, 17 monumentos, humedales, ecorregiones"
                        },
                        {
                                "FUENTE": "MapBiomas Chile",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://chile.mapbiomas.org/mapas-de-referencia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Colecci贸n 2.0 1985-2024, 37 clases cobertura/uso suelo 30m"
                        },
                        {
                                "FUENTE": "IDE Chile Uso de Suelo/Vegetaci贸n",
                                "Tipo": ".shp",
                                "ENLACE": "https://geoportal.cl/geoportal/catalog/35194/Catastros%20de%20Uso%20de%20Suelo%20y%20Vegetaci%C3%B3n",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Catastros regionales uso de suelo, categor铆as FAO/LCCS 1:25k-1:50k"
                        },
                        {
                                "FUENTE": "IDE Chile Zonas Clim谩ticas K枚ppen",
                                "Tipo": ".shp",
                                "ENLACE": "https://geoportal.cl/geoportal/catalog/35414/Zonas%20clim%C3%A1ticas%20de%20Chile",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "25 clases clim谩ticas K枚ppen-Geiger 1:1.5M, precipitaci贸n, temperatura"
                        },
                        {
                                "FUENTE": "SNA MMA 脕reas Protegidas SNAP",
                                "Tipo": ".shp",
                                "ENLACE": "https://sna.mma.gob.cl/centro-de-descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "SNASPE/SNAP bienes fiscales: parques, reservas, monumentos naturales"
                        },
                        {
                                "FUENTE": "IDE MINAGRI",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://ide.minagri.gob.cl/geoweb/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Infraestructura riego, canales, r铆os asociados"
                        },
                        {
                                "FUENTE": "datos.gob.cl IDE",
                                "Tipo": ".shp",
                                "ENLACE": "https://datos.gob.cl/organization/infraestructura-de-datos-geoespaciales-de-chile",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Aeropuertos, salud, humedales, tsunami"
                        },
                        {
                                "FUENTE": "ARCLIM MMA Clima",
                                "Tipo": "SHP,NetCDF",
                                "ENLACE": "https://arclim.mma.gob.cl/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos interpolados clim谩ticos, riesgo clim谩tico"
                        },
                        {
                                "FUENTE": "IDE MINVU",
                                "Tipo": "SHP",
                                "ENLACE": "https://ide.minvu.cl/pages/descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Instrumentos planificaci贸n territorial, uso suelo urbano"
                        }
],
                "total_fuentes": 29
        },
        "Uruguay": {
                "coords": [
                        -56.164531,
                        -32.522779
                ],
                "flag": "馃嚭馃嚲",
                "google_sheet": "https://docs.google.com/spreadsheets/d/1xFG459yv3e_0Vv0DRz2_gHxIsaLhkz6J/edit?gid=1336229882#gid=1336229882",
                "sheet_id": "1xFG459yv3e_0Vv0DRz2_gHxIsaLhkz6J",
                "gid": "1336229882",
                "fuentes": [
                        {
                                "FUENTE": "Instituto Nacional de Estad铆tica-INE",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.gub.uy/instituto-nacional-estadistica/cartografia",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Datos abiertos",
                                "Tipo": ".shp",
                                "ENLACE": "https://catalogodatos.gub.uy/dataset?res_format=SHP",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Datos abiertos",
                                "Tipo": ".shp",
                                "ENLACE": "https://catalogodatos.gub.uy/dataset/direccion-nacional-de-catastro-shapes-del-parcelario-rural-y-urbano",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "parcelario rural y urbano"
                        },
                        {
                                "FUENTE": "SIG Montevideo",
                                "Tipo": ".shp,kmz",
                                "ENLACE": "https://sig.montevideo.gub.uy/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Ministerio de Transporte y Obras P煤blicas-GEOPORTAL MTOP",
                                "Tipo": ".shp,kml",
                                "ENLACE": "https://geoportal.mtop.gub.uy/geoservicios",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "IDE",
                                "Tipo": "SHP",
                                "ENLACE": "https://visualizador.ide.uy/geonetwork/srv/search?format=Shapefile",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Portal de datos abiertos Montevideo",
                                "Tipo": "SHP",
                                "ENLACE": "https://ckan.montevideo.gub.uy/dataset/?res_format=SHP",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Diversas tem谩ticas"
                        },
                        {
                                "FUENTE": "Instituto Geogr谩fico Militar IGM",
                                "Tipo": "SHP",
                                "ENLACE": "https://igm.gub.uy/geoportal/cartografia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a Base"
                        },
                        {
                                "FUENTE": "GEOPORTAL IDE",
                                "Tipo": "SHP,TIF",
                                "ENLACE": "https://visualizador.ide.uy/ideuy/core/load_public_project/ideuy/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites admiistraivos,Catastro,OrtofotosHidrograf铆a,cuencas"
                        }
                ,
                        {
                                "FUENTE": "IDE Uruguay Descargas",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.gub.uy/infraestructura-datos-espaciales/descargas",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Divisi贸n pol铆tica, departamentos, datos espaciales oficiales IGN"
                        },
                        {
                                "FUENTE": "Cat谩logo Datos Abiertos Geogr谩ficos",
                                "Tipo": "SHP,GeoJSON",
                                "ENLACE": "https://catalogodatos.gub.uy/group/geograficos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos geogr谩ficos abiertos temas espec铆ficos"
                        },
                        {
                                "FUENTE": "MGAP Visualizadores Geogr谩ficos",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.gub.uy/ministerio-ganaderia-agricultura-pesca/visualizadores-geograficos",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Datos agropecuarios, suelo, ganader铆a"
                        },
                        {
                                "FUENTE": "IGM Datos Espaciales",
                                "Tipo": ".shp",
                                "ENLACE": "https://igm.gub.uy/download/datos-espaciales-del-uruguay/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Base cartogr谩fica oficial del Uruguay"
                        },
                        {
                                "FUENTE": "IDE Visualizador Descargas",
                                "Tipo": "SHP",
                                "ENLACE": "https://visualizador.ide.uy/descargas/datos/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrograf铆a, capas tem谩ticas descargables"
                        },
                        {
                                "FUENTE": "DINAMIGE Geominero",
                                "Tipo": "WFS,SHP",
                                "ENLACE": "https://visualizadorgeominero.dinamige.gub.uy/accesos/acceso.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa geol贸gico oficial, unidades geol贸gicas 1:500k"
                        },
                        {
                                "FUENTE": "MapBiomas Uruguay",
                                "Tipo": "TIFF,SHP",
                                "ENLACE": "https://uruguay.mapbiomas.org/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura 1985-2023, 8 clases uso suelo"
                        }
],
                "total_fuentes": 16
        }
,
        "Per煤": {
                "coords": [
                        -75.015152,
                        -9.189967
                ],
                "flag": "馃嚨馃嚜",
                "google_sheet": "",
                "sheet_id": "",
                "gid": "",
                "fuentes": [
                        {
                                "FUENTE": "IGN IDEP Hidrograf铆a 500k",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://www.geogpsperu.com/2016/10/rios-islas-lagos-y-lagunas-del-peru-ign.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "R铆os, lagos, lagunas, Lago Titicaca, hidrograf铆a nacional 1:500k"
                        },
                        {
                                "FUENTE": "IDEP Geoportal Descarga",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.idep.gob.pe/geovisor/descarga/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Base cartogr谩fica nacional IGN"
                        },
                        {
                                "FUENTE": "ANA Inventario Glaciares",
                                "Tipo": ".shp",
                                "ENLACE": "https://www.geogpsperu.com/2017/09/inventario-de-glaciares-ana-descargar.html",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "2.084 glaciares, 8.466 lagunas glaciares, 2.147 glaciares rocosos"
                        },
                        {
                                "FUENTE": "INAIGEM Geoportal Glaciares",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geoportal.inaigem.gob.pe/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Inventario glaciares 2023, 20 cordilleras"
                        },
                        {
                                "FUENTE": "MapBiomas Per煤",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://peru.mapbiomas.org/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Colecci贸n 3.0 1985-2024, 37 clases uso suelo por departamento/cuenca"
                        },
                        {
                                "FUENTE": "GEOCATMIN INGEMMET Geolog铆a",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geocatmin.ingemmet.gob.pe/geocatmin/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Carta Geol贸gica Nacional 1:1M, 501 cuadr谩ngulos 1:100k, geomorfolog铆a"
                        },
                        {
                                "FUENTE": "INGEMMET Mapa Geol贸gico",
                                "Tipo": ".shp",
                                "ENLACE": "https://portal.ingemmet.gob.pe/web/guest/mapa-geologico-nacional",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Unidades litol贸gicas, fallas, edades geol贸gicas"
                        },
                        {
                                "FUENTE": "SERNANP 脕reas Protegidas",
                                "Tipo": ".shp",
                                "ENLACE": "https://geo.sernanp.gob.pe/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "177 ANP: 76 parques/reservas, 20 reservas comunales, 18 santuarios, 17M ha"
                        },
                        {
                                "FUENTE": "MapBiomas Per煤 Capas",
                                "Tipo": "SHP",
                                "ENLACE": "https://peru.mapbiomas.org/capas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura/uso suelo biodiversidad 1985-2024, bosque nativo, ANP, ecorregiones"
                        },
                        {
                                "FUENTE": "SERFOR GeoSerfor",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geo.serfor.gob.pe/geoserfor/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Recursos forestales, fauna silvestre, cobertura forestal"
                        },
                        {
                                "FUENTE": "GEOCATMIN Geomorfolog铆a",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geocatmin.ingemmet.gob.pe/arcgis/rest/services/SERV_GEOMORFOLOGIA/MapServer",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geomorfol贸gico por regi贸n: monta帽as, llanuras, colinas, glaciares"
                        }
                ],
                "total_fuentes": 11
        },
        "Bolivia": {
                "coords": [
                        -63.588653,
                        -16.290154
                ],
                "flag": "馃嚙馃嚧",
                "google_sheet": "",
                "sheet_id": "",
                "gid": "",
                "fuentes": [
                        {
                                "FUENTE": "GeoBolivia IDE-EPB",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://geo.gob.bo",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cuencas nivel 1 (13 principales), subcuencas, datos espaciales nacionales"
                        },
                        {
                                "FUENTE": "GeoBolivia Atlas Interactivo",
                                "Tipo": "SHP",
                                "ENLACE": "https://ideepb.geo.gob.bo/atlas-interactivo/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Atlas interactivo: Plata, Amazonas, Paran谩, Cuenca Cerrada"
                        },
                        {
                                "FUENTE": "SERGEOMIN IDE Geolog铆a",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "http://ide.sergeomin.gob.bo",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapa Geol贸gico 1:1M, formaciones, fallas, GeoVisor exportable"
                        },
                        {
                                "FUENTE": "SERGEOMIN GeoVisor",
                                "Tipo": "SHP",
                                "ENLACE": "http://ide.sergeomin.gob.bo/glgsgm/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Capas geol贸gicas-mineras: granitos, areniscas, lavas, lutitas"
                        },
                        {
                                "FUENTE": "MapBiomas Bolivia Capas",
                                "Tipo": "SHP",
                                "ENLACE": "https://bolivia.mapbiomas.org/capas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura suelo biomas 1985-2023, 7 biomas: Amazon铆a, Chiquitano"
                        },
                        {
                                "FUENTE": "MapBiomas Bolivia Descargas",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://bolivia.mapbiomas.org/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Colecci贸n 3.0: 37 clases, bosque nativo 41%, pastizal 25%, agricultura 20%"
                        }
                ],
                "total_fuentes": 6
        },
        "Paraguay": {
                "coords": [
                        -58.443832,
                        -23.442503
                ],
                "flag": "馃嚨馃嚲",
                "google_sheet": "",
                "sheet_id": "",
                "gid": "",
                "fuentes": [
                        {
                                "FUENTE": "Datos.gov.py Administrativos",
                                "Tipo": "GeoJSON,SHP",
                                "ENLACE": "https://www.datos.gov.py/dataset/base-de-datos-geojson-geoespacial-de-departamentos-distritos-ciudades-y-barrios-de-todo-el-4",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "17 departamentos, distritos, ciudades, barrios"
                        },
                        {
                                "FUENTE": "INE Cartograf铆a Digital",
                                "Tipo": "SHP",
                                "ENLACE": "https://www.ine.gov.py/microdatos/cartografia-digital-2012.php",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cartograf铆a digital actualizada 2012"
                        },
                        {
                                "FUENTE": "Portal Geoestad铆stico INE",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://portalgeoestad.ine.gov.py",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrograf铆a, estad铆sticas georreferenciadas"
                        },
                        {
                                "FUENTE": "Datos.gov.py Portal",
                                "Tipo": "SHP,GeoJSON",
                                "ENLACE": "https://www.datos.gov.py/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hidrograf铆a, 谩reas protegidas, datos abiertos"
                        },
                        {
                                "FUENTE": "Viceministerio Minas - Geolog铆a",
                                "Tipo": "SHP,PDF",
                                "ENLACE": "https://minasyenergia.mopc.gov.py/index.php?option=com_content&view=article&id=1679",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Hojas geol贸gicas, mapas geol贸gicos nacionales"
                        },
                        {
                                "FUENTE": "Geolog铆a del Paraguay",
                                "Tipo": "SHP,PDF",
                                "ENLACE": "https://www.geologiadelparaguay.com.py/Mapas.htm",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Mapas geol贸gicos 2022-2024"
                        },
                        {
                                "FUENTE": "MADES 脕reas Protegidas",
                                "Tipo": "SHP",
                                "ENLACE": "https://apps.mades.gov.py/siam/portal/indicadores/biodiversidad",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "SINASIP 谩reas silvestres protegidas, planes manejo, l铆mites"
                        },
                        {
                                "FUENTE": "MapBiomas Paraguay",
                                "Tipo": "TIFF,SHP",
                                "ENLACE": "https://paraguay.mapbiomas.org/descargas/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Cobertura vegetal raster, 37 clases, estad铆sticas transiciones bosque"
                        }
                ],
                "total_fuentes": 8
        },
        "Venezuela": {
                "coords": [
                        -66.58973,
                        6.42375
                ],
                "flag": "馃嚮馃嚜",
                "google_sheet": "",
                "sheet_id": "",
                "gid": "",
                "fuentes": [
                        {
                                "FUENTE": "IGVSB Capas Base",
                                "Tipo": "SHP",
                                "ENLACE": "https://igvsb.gob.ve/servicio/7",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Divisi贸n estados/municipios, hidrograf铆a, geolog铆a hojas regionales 1:250k"
                        },
                        {
                                "FUENTE": "Geoportal ANI Datos Geoespaciales",
                                "Tipo": "SHP,WMS",
                                "ENLACE": "https://venezuela-anihcgd.opendata.arcgis.com/pages/geoespacial",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "L铆mites nacional/estados/municipios, datos geoespaciales"
                        },
                        {
                                "FUENTE": "MapBiomas Venezuela",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://venezuela.mapbiomas.org/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Biomas, ANP, cobertura vegetal, colecci贸n 3 raster 1985-2024"
                        },
                        {
                                "FUENTE": "MapBiomas Venezuela Colecciones",
                                "Tipo": "SHP,TIFF",
                                "ENLACE": "https://venezuela.mapbiomas.org/colecciones-de-mapbiomas-venezuela/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Colecci贸n 3 raster 1985-2024, l铆mites vectoriales"
                        },
                        {
                                "FUENTE": "MapBiomas Venezuela 脕reas Protegidas",
                                "Tipo": "SHP",
                                "ENLACE": "https://venezuela.mapbiomas.org/mapas-de-referencia/",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "~350 parques 谩reas protegidas, cuencas 7 principales, ecosistemas"
                        },
                        {
                                "FUENTE": "USGS Mapa Geol贸gico Venezuela",
                                "Tipo": ".shp",
                                "ENLACE": "https://pubs.usgs.gov/ds/2006/199/USGS_06_DS_199.zip",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Unidades litol贸gicas, mapa geol贸gico nacional"
                        },
                        {
                                "FUENTE": "Geoportal Provita",
                                "Tipo": "SHP",
                                "ENLACE": "https://geoportal.provita.org.ve",
                                "ENLACE_ORIGINAL": "Acceso",
                                "CAPAS": "Ecosistemas terrestres, Libro Rojo, biodiversidad"
                        }
                ],
                "total_fuentes": 7
        }
};
        // Variables globales
        let map;
        let currentCountry = null;
        let currentGoogleSheet = null;
        let currentSheetId = null;
        let currentGid = null;
        let allSources = [];
        let markers = [];

        // Inicializar mapa
        function initMap() {
            map = L.map('map', {
                center: [-10, -60],
                zoom: 3,
                minZoom: 2,
                maxZoom: 18
            });

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '漏 OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);

            addCountryMarkers();
            updateGlobalStats();
        }

        // Actualizar estad铆sticas globales
        function updateGlobalStats() {
            const total = Object.values(paisesData).reduce((sum, p) => sum + p.total_fuentes, 0);
            document.getElementById('total-global-sources').textContent = total + ' fuentes';
            const countriesEl = document.getElementById('total-countries-legend');
            if (countriesEl) countriesEl.innerHTML = Object.keys(paisesData).length + ' pa铆ses';
        }

        // Agregar marcadores
        function addCountryMarkers() {
            Object.entries(paisesData).forEach(([pais, datos]) => {
                const markerHtml = '<div style="width: 40px; height: 40px; border-radius: 50%; background: #059669; border: 3px solid white; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer;">' + datos.total_fuentes + '</div>';
                
                const markerIcon = L.divIcon({
                    className: 'country-marker',
                    html: markerHtml,
                    iconSize: [40, 40],
                    iconAnchor: [20, 20]
                });

                const marker = L.marker([datos.coords[1], datos.coords[0]], {
                    icon: markerIcon
                }).addTo(map);

                const popupContent = '<div class="custom-popup"><h3>' + datos.flag + ' ' + pais + '</h3><p><strong>' + datos.total_fuentes + '</strong> fuentes de datos disponibles</p></div>';

                marker.bindPopup(popupContent);
                marker.on('click', function() {
                    openCountryPanel(pais);
                });

                markers.push({marker: marker, pais: pais});
            });
        }

        // Cargar datos desde Google Sheets
        async function loadFromGoogleSheets(sheetId, gid) {
            try {
                const csvUrl = 'https://docs.google.com/spreadsheets/d/' + sheetId + '/export?format=csv&gid=' + gid;
                
                const response = await fetch(csvUrl);
                const csvText = await response.text();
                
                return new Promise((resolve, reject) => {
                    Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            const fuentes = results.data.map(function(row) {
                                return {
                                    FUENTE: row.FUENTE || row.fuente || '',
                                    Tipo: row.Tipo || row.tipo || row.TIPO || '',
                                    ENLACE: row['Unnamed: 4'] || row.ENLACE || row.enlace || '',
                                    ENLACE_ORIGINAL: row.ENLACE || row.enlace || 'Acceso',
                                    CAPAS: row.CAPAS || row.capas || ''
                                };
                            }).filter(function(f) {
                                return f.FUENTE && f.FUENTE.trim();
                            });
                            
                            resolve(fuentes);
                        },
                        error: function(error) {
                            reject(error);
                        }
                    });
                });
            } catch (error) {
                console.error('Error loading from Google Sheets:', error);
                return null;
            }
        }

        // Actualizar datos del pa铆s desde Google Sheets
        async function refreshCountryData() {
            if (!currentCountry || !currentSheetId || !currentGid) return;
            
            const refreshBtn = document.getElementById('refresh-btn');
            const refreshIcon = document.getElementById('refresh-icon');
            
            refreshBtn.classList.add('loading');
            refreshIcon.classList.add('spin');
            
            try {
                const newFuentes = await loadFromGoogleSheets(currentSheetId, currentGid);
                
                if (newFuentes) {
                    paisesData[currentCountry].fuentes = newFuentes;
                    paisesData[currentCountry].total_fuentes = newFuentes.length;
                    
                    allSources = newFuentes;
                    renderSources(allSources);
                    
                    document.getElementById('total-sources').textContent = newFuentes.length;
                    const tipos = new Set(newFuentes.map(function(f) { return f.Tipo; }));
                    document.getElementById('total-types').textContent = tipos.size;
                    
                    // Actualizar marcador
                    updateMarker(currentCountry, newFuentes.length);
                    
                    // Actualizar estad铆sticas globales
                    updateGlobalStats();
                    
                    const now = new Date().toLocaleTimeString('es-ES');
                    document.getElementById('last-update').textContent = '脷ltima actualizaci贸n: ' + now;
                } else {
                    alert('No se pudo actualizar los datos. Verifica la conexi贸n.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error al actualizar datos.');
            } finally {
                refreshBtn.classList.remove('loading');
                refreshIcon.classList.remove('spin');
            }
        }

        // Actualizar marcador del pa铆s
        function updateMarker(pais, totalFuentes) {
            const datos = paisesData[pais];
            markers.forEach(function(m) {
                if (m.pais === pais) {
                    const markerHtml = '<div style="width: 40px; height: 40px; border-radius: 50%; background: #059669; border: 3px solid white; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer;">' + totalFuentes + '</div>';
                    
                    const newIcon = L.divIcon({
                        className: 'country-marker',
                        html: markerHtml,
                        iconSize: [40, 40],
                        iconAnchor: [20, 20]
                    });
                    m.marker.setIcon(newIcon);
                }
            });
        }

        // Abrir panel del pa铆s
        function openCountryPanel(pais) {
            currentCountry = pais;
            const datos = paisesData[pais];
            currentGoogleSheet = datos.google_sheet;
            currentSheetId = datos.sheet_id;
            currentGid = datos.gid;
            
            document.getElementById('country-flag').textContent = datos.flag;
            document.getElementById('country-text').textContent = pais;
            document.getElementById('total-sources').textContent = datos.total_fuentes;
            
            const tipos = new Set(datos.fuentes.map(function(f) { return f.Tipo; }));
            document.getElementById('total-types').textContent = tipos.size;
            
            allSources = datos.fuentes;
            renderSources(allSources);
            
            // Mostrar/ocultar bot贸n eliminar pa铆s
            const deleteBanner = document.getElementById('deleteCountryBanner');
            if (deleteBanner) {
                deleteBanner.style.display = datos.total_fuentes === 0 ? 'flex' : 'none';
            }
            
            document.getElementById('last-update').textContent = '脷ltima actualizaci贸n: Datos locales';
            document.getElementById('sidebar').classList.add('active');
        }

        // Cerrar sidebar
        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('active');
            currentCountry = null;
            currentGoogleSheet = null;
            currentSheetId = null;
            currentGid = null;
        }

        // Abrir Google Sheet
        function openGoogleSheet() {
            if (currentGoogleSheet) {
                window.open(currentGoogleSheet, '_blank');
            }
        }

        // Buscar fuente en Google
        function searchSource(fuente) {
            const query = encodeURIComponent(fuente + ' datos gis');
            window.open('https://www.google.com/search?q=' + query, '_blank');
        }

        // Abrir enlace de fuente
        function openSourceLink(enlace, fuente) {
            if (enlace && enlace.startsWith('http')) {
                window.open(enlace, '_blank');
            } else {
                searchSource(fuente);
            }
        }

        // Renderizar fuentes
        function renderSources(sources) {
            const container = document.getElementById('sources-list');
            
            if (sources.length === 0) {
                container.innerHTML = '<div class="no-results"><p>No se encontraron fuentes con ese criterio de b煤squeda</p></div>';
                return;
            }
            
            container.innerHTML = sources.map((fuente, index) => {
                const capas = fuente.CAPAS ? fuente.CAPAS.split(',').map(c => c.trim()).filter(c => c) : [];
                const enlace = fuente.ENLACE || '';
                const hasLink = enlace.startsWith('http');
                const enlaceText = fuente.ENLACE_ORIGINAL || 'Acceso';
                
                return `
                    <div class="source-card" style="animation-delay: ${index * 0.05}s">
                        <div class="source-actions" onclick="event.stopPropagation();">
                            <button type="button" class="action-icon edit" onclick="event.stopPropagation(); event.preventDefault(); editarFuente(${index}); return false;" title="Editar">
                                鉁忥笍
                            </button>
                            <button type="button" class="action-icon delete" onclick="event.stopPropagation(); event.preventDefault(); eliminarFuente(${index}); return false;" title="Eliminar">
                                馃棏锔?                            </button>
                        </div>
                        <div onclick="openSourceLink('${enlace.replace(/'/g, "\\'")}','${fuente.FUENTE.replace(/'/g, "\\'")}')">
                            <div class="source-header">
                                <div class="source-name">${fuente.FUENTE}</div>
                                <div class="source-type">${fuente.Tipo}</div>
                            </div>
                            <div class="source-details">
                                <div class="detail-label">Acceso:</div>
                                <div class="detail-value">
                                    <span class="access-badge ${!hasLink ? 'warning' : ''}">${hasLink ? '鉁?Enlace Directo' : enlaceText}</span>
                                </div>
                                ${capas.length > 0 ? `
                                <div class="detail-label">Capas:</div>
                                <div class="detail-value">
                                    ${capas.slice(0, 5).map(c => `<span class="layers-tag">${c}</span>`).join('')}
                                    ${capas.length > 5 ? `<span class="layers-tag">+${capas.length - 5} m谩s</span>` : ''}
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Inicializar al cargar
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('search-input').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                
                if (!currentCountry) return;
                
                const filtered = allSources.filter(function(fuente) {
                    return fuente.FUENTE.toLowerCase().includes(searchTerm) ||
                           fuente.CAPAS.toLowerCase().includes(searchTerm) ||
                           fuente.Tipo.toLowerCase().includes(searchTerm);
                });
                
                renderSources(filtered);
                document.getElementById('total-sources').textContent = filtered.length;
            });

            document.getElementById('sidebar').addEventListener('transitionend', function() {
                if (map) map.invalidateSize();
            });

            document.getElementById('leftPanel').addEventListener('transitionend', function() {
                if (map) map.invalidateSize();
            });

            initMap();
        });
    
        
        // ========== FUNCIONES DEL FORMULARIO ==========
        
        // Cargar datos guardados
        (function() {
            const saved = localStorage.getItem('geovisor_data');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    Object.keys(data).forEach(p => {
                        if (paisesData[p]) {
                            // Actualizar pa铆s existente
                            paisesData[p] = data[p];
                        } else {
                            // Pa铆s nuevo agregado por el usuario
                            paisesData[p] = data[p];
                        }
                    });
                    console.log('鉁?Datos cargados (' + Object.keys(paisesData).length + ' pa铆ses)');
                } catch(e) {
                    console.error('Error:', e);
                }
            }
        })();
        

        
        // ========== EDITAR Y ELIMINAR FUENTES ==========
        
        let indiceEditando = -1; // -1 = modo crear, >= 0 = modo editar
        
        function editarFuente(index) {
            indiceEditando = index;
            const fuente = paisesData[currentCountry].fuentes[index];
            
            // Cambiar t铆tulo del modal
            document.getElementById('modalTitulo').innerHTML = '鉁忥笍 Editar Fuente GIS';
            document.getElementById('btnGuardar').textContent = 'Actualizar';
            
            // Llenar formulario con datos existentes
            document.getElementById('paisForm').textContent = paisesData[currentCountry].flag + ' ' + currentCountry;
            document.getElementById('f1').value = fuente.FUENTE;
            document.getElementById('f2').value = fuente.Tipo;
            document.getElementById('f3').value = fuente.ENLACE || '';
            document.getElementById('f4').value = fuente.CAPAS;
            
            // Abrir modal
            document.getElementById('modalFormulario').style.display = 'block';
        }
        
        function eliminarFuente(index) {
            const fuente = paisesData[currentCountry].fuentes[index];
            
            if (!confirm(`驴Eliminar "${fuente.FUENTE}"?\n\nEsta acci贸n no se puede deshacer.`)) {
                return;
            }
            
            // Eliminar de los datos
            paisesData[currentCountry].fuentes.splice(index, 1);
            paisesData[currentCountry].total_fuentes--;
            
            // Guardar en localStorage
            localStorage.setItem('geovisor_data', JSON.stringify(paisesData));
            
            // Actualizar interfaz
            allSources = paisesData[currentCountry].fuentes;
            renderSources(allSources);
            document.getElementById('total-sources').textContent = paisesData[currentCountry].total_fuentes;
            
            const tipos = new Set(paisesData[currentCountry].fuentes.map(f => f.Tipo));
            document.getElementById('total-types').textContent = tipos.size;
            
            // Actualizar marcador
            updateMarker(currentCountry, paisesData[currentCountry].total_fuentes);
            updateGlobalStats();
            
            // Notificaci贸n
            mostrarNotificacion('鉁?Fuente eliminada. Total: ' + paisesData[currentCountry].total_fuentes);
            
            // Mostrar bot贸n eliminar pa铆s si qued贸 en 0
            const deleteBanner = document.getElementById('deleteCountryBanner');
            if (deleteBanner) {
                deleteBanner.style.display = paisesData[currentCountry].total_fuentes === 0 ? 'flex' : 'none';
            }
        }
        function abrirFormulario() {
            if (!currentCountry) {
                alert('Primero selecciona un pa铆s en el mapa');
                return;
            }
            
            // Resetear modo a "crear"
            indiceEditando = -1;
            document.getElementById('modalTitulo').innerHTML = '鉃?Agregar Nueva Fuente GIS';
            document.getElementById('btnGuardar').textContent = 'Guardar';
            
            const pais = paisesData[currentCountry];
            document.getElementById('paisForm').textContent = pais.flag + ' ' + currentCountry;
            document.getElementById('modalFormulario').style.display = 'block';
            
            // Limpiar campos
            document.getElementById('f1').value = '';
            document.getElementById('f2').value = '';
            document.getElementById('f3').value = '';
            document.getElementById('f4').value = '';
        }
        
        function cerrarFormulario() {
            document.getElementById('modalFormulario').style.display = 'none';
        }
        
        function guardarFuente() {
            const fuente = document.getElementById('f1').value.trim();
            const tipo = document.getElementById('f2').value;
            const enlace = document.getElementById('f3').value.trim();
            const capas = document.getElementById('f4').value.trim();
            
            if (!fuente || !tipo || !capas) {
                alert('Por favor completa los campos obligatorios (*)');
                return;
            }
            
            const fuenteData = {
                FUENTE: fuente,
                Tipo: tipo,
                ENLACE: enlace || '',
                ENLACE_ORIGINAL: 'Acceso',
                CAPAS: capas
            };
            
            if (indiceEditando >= 0) {
                // MODO EDITAR: actualizar fuente existente
                paisesData[currentCountry].fuentes[indiceEditando] = fuenteData;
                mostrarNotificacion('鉁?Fuente actualizada exitosamente!');
            } else {
                // MODO CREAR: agregar nueva fuente
                paisesData[currentCountry].fuentes.push(fuenteData);
                paisesData[currentCountry].total_fuentes++;
                mostrarNotificacion('鉁?Fuente agregada! Total: ' + paisesData[currentCountry].total_fuentes);
            }
            
            // Guardar en localStorage
            localStorage.setItem('geovisor_data', JSON.stringify(paisesData));
            
            // Actualizar interfaz
            allSources = paisesData[currentCountry].fuentes;
            renderSources(allSources);
            document.getElementById('total-sources').textContent = paisesData[currentCountry].total_fuentes;
            
            const tipos = new Set(paisesData[currentCountry].fuentes.map(f => f.Tipo));
            document.getElementById('total-types').textContent = tipos.size;
            
            // Actualizar marcador
            updateMarker(currentCountry, paisesData[currentCountry].total_fuentes);
            updateGlobalStats();
            
            // Ocultar bot贸n eliminar pa铆s (ya tiene fuentes)
            const deleteBanner = document.getElementById('deleteCountryBanner');
            if (deleteBanner) deleteBanner.style.display = 'none';
            
            // Cerrar formulario
            cerrarFormulario();
            
            // Resetear modo
            indiceEditando = -1;
        }
        
        function mostrarNotificacion(msg) {
            const notif = document.createElement('div');
            notif.className = 'notif';
            notif.textContent = msg;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 3000);
        }
        
        // Cerrar modal al hacer clic fuera
        window.addEventListener('click', function(e) {
            if (e.target.id === 'modalFormulario') {
                cerrarFormulario();
            }
            if (e.target.id === 'modalNuevoPais') {
                cerrarModalPais();
            }
        });

        // ========== AGREGAR NUEVO PA脥S ==========
        
        let pickingCoords = false;
        let pickedLat = null;
        let pickedLng = null;
        let selectedFlag = '馃搷';
        let tempPickMarker = null;

        const flagEmojis = [
            '馃嚘馃嚝','馃嚘馃嚤','馃嚛馃嚳','馃嚘馃嚛','馃嚘馃嚧','馃嚘馃嚞','馃嚘馃嚪','馃嚘馃嚥','馃嚘馃嚭','馃嚘馃嚬',
            '馃嚘馃嚳','馃嚙馃嚫','馃嚙馃嚟','馃嚙馃嚛','馃嚙馃嚙','馃嚙馃嚲','馃嚙馃嚜','馃嚙馃嚳','馃嚙馃嚡','馃嚙馃嚬',
            '馃嚙馃嚧','馃嚙馃嚘','馃嚙馃嚰','馃嚙馃嚪','馃嚙馃嚦','馃嚙馃嚞','馃嚙馃嚝','馃嚙馃嚠','馃嚢馃嚟','馃嚚馃嚥',
            '馃嚚馃嚘','馃嚚馃嚮','馃嚚馃嚝','馃嚬馃嚛','馃嚚馃嚤','馃嚚馃嚦','馃嚚馃嚧','馃嚢馃嚥','馃嚚馃嚞','馃嚚馃嚪',
            '馃嚟馃嚪','馃嚚馃嚭','馃嚚馃嚲','馃嚚馃嚳','馃嚛馃嚢','馃嚛馃嚡','馃嚛馃嚥','馃嚛馃嚧','馃嚜馃嚚','馃嚜馃嚞',
            '馃嚫馃嚮','馃嚞馃嚩','馃嚜馃嚪','馃嚜馃嚜','馃嚜馃嚬','馃嚝馃嚡','馃嚝馃嚠','馃嚝馃嚪','馃嚞馃嚘','馃嚞馃嚥',
            '馃嚞馃嚜','馃嚛馃嚜','馃嚞馃嚟','馃嚞馃嚪','馃嚞馃嚛','馃嚞馃嚬','馃嚞馃嚦','馃嚞馃嚰','馃嚞馃嚲','馃嚟馃嚬',
            '馃嚟馃嚦','馃嚟馃嚭','馃嚠馃嚫','馃嚠馃嚦','馃嚠馃嚛','馃嚠馃嚪','馃嚠馃嚩','馃嚠馃嚜','馃嚠馃嚤','馃嚠馃嚬',
            '馃嚡馃嚥','馃嚡馃嚨','馃嚡馃嚧','馃嚢馃嚳','馃嚢馃嚜','馃嚢馃嚠','馃嚢馃嚰','馃嚢馃嚞','馃嚤馃嚘','馃嚤馃嚮',
            '馃嚤馃嚙','馃嚤馃嚫','馃嚤馃嚪','馃嚤馃嚲','馃嚤馃嚠','馃嚤馃嚬','馃嚤馃嚭','馃嚥馃嚞','馃嚥馃嚰','馃嚥馃嚲',
            '馃嚥馃嚮','馃嚥馃嚤','馃嚥馃嚬','馃嚥馃嚟','馃嚥馃嚪','馃嚥馃嚭','馃嚥馃嚱','馃嚥馃嚛','馃嚥馃嚚','馃嚥馃嚦',
            '馃嚥馃嚜','馃嚥馃嚘','馃嚥馃嚳','馃嚥馃嚥','馃嚦馃嚘','馃嚦馃嚪','馃嚦馃嚨','馃嚦馃嚤','馃嚦馃嚳','馃嚦馃嚠',
            '馃嚦馃嚜','馃嚦馃嚞','馃嚢馃嚨','馃嚥馃嚢','馃嚦馃嚧','馃嚧馃嚥','馃嚨馃嚢','馃嚨馃嚰','馃嚨馃嚘','馃嚨馃嚞',
            '馃嚨馃嚲','馃嚨馃嚜','馃嚨馃嚟','馃嚨馃嚤','馃嚨馃嚬','馃嚩馃嚘','馃嚪馃嚧','馃嚪馃嚭','馃嚪馃嚰','馃嚰馃嚫',
            '馃嚫馃嚥','馃嚫馃嚬','馃嚫馃嚘','馃嚫馃嚦','馃嚪馃嚫','馃嚫馃嚚','馃嚫馃嚤','馃嚫馃嚞','馃嚫馃嚢','馃嚫馃嚠',
            '馃嚫馃嚙','馃嚫馃嚧','馃嚳馃嚘','馃嚢馃嚪','馃嚫馃嚫','馃嚜馃嚫','馃嚤馃嚢','馃嚫馃嚛','馃嚫馃嚪','馃嚫馃嚜',
            '馃嚚馃嚟','馃嚫馃嚲','馃嚬馃嚰','馃嚬馃嚡','馃嚬馃嚳','馃嚬馃嚟','馃嚬馃嚤','馃嚬馃嚞','馃嚬馃嚧','馃嚬馃嚬',
            '馃嚬馃嚦','馃嚬馃嚪','馃嚬馃嚥','馃嚬馃嚮','馃嚭馃嚞','馃嚭馃嚘','馃嚘馃嚜','馃嚞馃嚙','馃嚭馃嚫','馃嚭馃嚲',
            '馃嚭馃嚳','馃嚮馃嚭','馃嚮馃嚜','馃嚮馃嚦','馃嚲馃嚜','馃嚳馃嚥','馃嚳馃嚰','馃彸锔?,'馃實','馃寧','馃審'
        ];

        function renderEmojiGrid() {
            const grid = document.getElementById('emojiGrid');
            grid.innerHTML = flagEmojis.map(f => 
                `<div class="emoji-opt${f === selectedFlag ? ' selected' : ''}" onclick="seleccionarFlag(this, '${f}')">${f}</div>`
            ).join('');
        }

        function seleccionarFlag(el, flag) {
            document.querySelectorAll('.emoji-opt').forEach(e => e.classList.remove('selected'));
            el.classList.add('selected');
            selectedFlag = flag;
        }

        function abrirModalPais() {
            // Reset form
            document.getElementById('npNombre').value = '';
            pickedLat = null;
            pickedLng = null;
            selectedFlag = '馃搷';
            
            const picker = document.getElementById('coordPicker');
            picker.classList.remove('picked');
            document.getElementById('coordValues').style.display = 'none';
            picker.querySelector('.coord-text').textContent = 'Haz clic aqu铆 y luego en el mapa para seleccionar la ubicaci贸n';
            picker.querySelector('.coord-icon').textContent = '馃搷';
            
            renderEmojiGrid();
            document.getElementById('modalNuevoPais').style.display = 'block';
        }

        function cerrarModalPais() {
            document.getElementById('modalNuevoPais').style.display = 'none';
            cancelarPicking();
        }

        function iniciarPicking() {
            // Hide modal temporarily
            document.getElementById('modalNuevoPais').style.display = 'none';
            
            // Show picking banner
            document.getElementById('pickingBanner').style.display = 'block';
            
            // Enter picking mode
            pickingCoords = true;
            document.getElementById('map').classList.add('map-picking-mode');
            
            // Add click listener to map
            map.once('click', function(e) {
                pickedLat = e.latlng.lat;
                pickedLng = e.latlng.lng;
                
                // Show temp marker
                if (tempPickMarker) {
                    map.removeLayer(tempPickMarker);
                }
                const tempIcon = L.divIcon({
                    className: 'country-marker',
                    html: '<div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b, #d97706); border: 3px solid white; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); animation: fadeIn 0.3s;">?</div>',
                    iconSize: [40, 40],
                    iconAnchor: [20, 20]
                });
                tempPickMarker = L.marker([pickedLat, pickedLng], { icon: tempIcon }).addTo(map);
                
                // Exit picking mode
                finalizarPicking();
            });
        }

        function finalizarPicking() {
            pickingCoords = false;
            document.getElementById('map').classList.remove('map-picking-mode');
            document.getElementById('pickingBanner').style.display = 'none';
            
            // Reopen modal
            document.getElementById('modalNuevoPais').style.display = 'block';
            
            // Update coord display
            if (pickedLat !== null) {
                const picker = document.getElementById('coordPicker');
                picker.classList.add('picked');
                picker.querySelector('.coord-icon').textContent = '鉁?;
                picker.querySelector('.coord-text').textContent = 'Ubicaci贸n seleccionada';
                const coordValues = document.getElementById('coordValues');
                coordValues.textContent = `Lat: ${pickedLat.toFixed(4)}  |  Lng: ${pickedLng.toFixed(4)}`;
                coordValues.style.display = 'block';
            }
        }

        function cancelarPicking() {
            pickingCoords = false;
            document.getElementById('map').classList.remove('map-picking-mode');
            document.getElementById('pickingBanner').style.display = 'none';
            
            // Remove temp marker
            if (tempPickMarker) {
                map.removeLayer(tempPickMarker);
                tempPickMarker = null;
            }
            
            // Remove pending map click
            map.off('click');
            // Re-attach normal marker clicks
        }

        function guardarNuevoPais() {
            const nombre = document.getElementById('npNombre').value.trim();
            
            if (!nombre) {
                alert('Por favor ingresa el nombre del pa铆s');
                return;
            }
            
            if (paisesData[nombre]) {
                alert('Este pa铆s ya existe en el geovisor. Selecci贸nalo en el mapa para agregar fuentes.');
                return;
            }
            
            if (pickedLat === null || pickedLng === null) {
                alert('Por favor selecciona la ubicaci贸n en el mapa haciendo clic en el 谩rea de coordenadas');
                return;
            }
            
            // Create country data
            paisesData[nombre] = {
                coords: [pickedLng, pickedLat],
                flag: selectedFlag,
                google_sheet: "",
                sheet_id: "",
                gid: "",
                fuentes: [],
                total_fuentes: 0
            };
            
            // Add marker to map
            const markerHtml = '<div style="width: 40px; height: 40px; border-radius: 50%; background: #059669; border: 3px solid white; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer;">0</div>';
            const markerIcon = L.divIcon({
                className: 'country-marker',
                html: markerHtml,
                iconSize: [40, 40],
                iconAnchor: [20, 20]
            });
            
            // Remove temp marker
            if (tempPickMarker) {
                map.removeLayer(tempPickMarker);
                tempPickMarker = null;
            }
            
            const marker = L.marker([pickedLat, pickedLng], { icon: markerIcon }).addTo(map);
            const popupContent = '<div class="custom-popup"><h3>' + selectedFlag + ' ' + nombre + '</h3><p><strong>0</strong> fuentes de datos disponibles</p></div>';
            marker.bindPopup(popupContent);
            marker.on('click', function() {
                openCountryPanel(nombre);
            });
            markers.push({ marker: marker, pais: nombre });
            
            // Save to localStorage
            localStorage.setItem('geovisor_data', JSON.stringify(paisesData));
            
            // Update global stats
            updateGlobalStats();
            updateCountryLegend();
            
            // Close modal
            cerrarModalPais();
            
            // Notification
            mostrarNotificacion('鉁?' + selectedFlag + ' ' + nombre + ' agregado al geovisor! Haz clic en el marcador para a帽adir fuentes GIS.');
            
            // Open the country panel so user can start adding sources
            setTimeout(function() {
                openCountryPanel(nombre);
            }, 500);
        }

        function updateCountryLegend() {
            const total = Object.keys(paisesData).length;
            const el = document.getElementById('total-countries-legend');
            if (el) el.innerHTML = total + ' pa铆ses';
        }

        function eliminarPais() {
            if (!currentCountry) return;
            
            const datos = paisesData[currentCountry];
            
            // Solo permitir si tiene 0 fuentes
            if (datos.total_fuentes > 0) {
                alert('No se puede eliminar un pa铆s que tiene fuentes de datos.\nPrimero elimina todas las fuentes.');
                return;
            }
            
            if (!confirm('驴Eliminar "' + datos.flag + ' ' + currentCountry + '" del mapa?\n\nEsta acci贸n no se puede deshacer.')) {
                return;
            }
            
            const paisEliminado = currentCountry;
            
            // Eliminar marcador del mapa
            for (let i = markers.length - 1; i >= 0; i--) {
                if (markers[i].pais === paisEliminado) {
                    map.removeLayer(markers[i].marker);
                    markers.splice(i, 1);
                    break;
                }
            }
            
            // Eliminar del objeto de datos
            delete paisesData[paisEliminado];
            
            // Guardar en localStorage
            localStorage.setItem('geovisor_data', JSON.stringify(paisesData));
            
            // Cerrar sidebar
            closeSidebar();
            
            // Actualizar estad铆sticas
            updateGlobalStats();
            updateCountryLegend();
            
            // Notificaci贸n
            mostrarNotificacion('鉁?' + paisEliminado + ' eliminado del mapa');
        }

        // ========== PANEL GLOBAL GIS ==========
        
        const gisDataDefault = [{"name":"Natural Earth - Vector","region":"global","category":"fisica","type":"limites","description":"Incluye costa, tierra firme, oc茅anos, islas, r铆os, lagos, zonas glaciares y batimetr铆a. Disponible con m煤ltiples niveles de detalle.","url":"https://www.naturalearthdata.com/"},{"name":"GDEM - Elevaci贸n Global","region":"global","category":"fisica","type":"elevacion","description":"Datos de elevaci贸n global con una resoluci贸n de 30 m derivados de im谩genes satelitales ASTER","url":"https://asterweb.jpl.nasa.gov/gdem.asp"},{"name":"SRTM - Elevaci贸n","region":"global","category":"fisica","type":"elevacion","description":"Datos de elevaci贸n con una resoluci贸n aproximada de 90 m (3 segundos de arco) de la Misi贸n de Topograf铆a Radar del Transbordador Espacial","url":"http://srtm.csi.cgiar.org/"},{"name":"WorldClim","region":"global","category":"fisica","type":"clima","description":"Datos clim谩ticos de condiciones pasadas, presentes y futuras. Incluye temperatura y precipitaci贸n. Resoluci贸n de 1 km x 1 km.","url":"https://www.worldclim.org/"},{"name":"HydroSHEDS","region":"global","category":"fisica","type":"hidrologia","description":"Datos hidrol贸gicos y mapas basados en datos de elevaci贸n SRTM. Incluye redes fluviales, l铆mites de cuencas y direcciones de drenaje a nivel mundial.","url":"https://www.hydrosheds.org/"},{"name":"GLOBCOVER","region":"global","category":"fisica","type":"cobertura","description":"Conjunto de datos de cobertura terrestre global con una resoluci贸n de 300 m del sensor MERIS del sat茅lite ENVISAT","url":"http://due.esrin.esa.int/page_globcover.php"},{"name":"MODIS - Cobertura Terrestre Global","region":"global","category":"fisica","type":"cobertura","description":"Mapas de cobertura terrestre global con resoluci贸n de 1 km y 4 km derivados de im谩genes MODIS","url":"https://modis.gsfc.nasa.gov/"},{"name":"Cambio Forestal Global 2000-2014","region":"global","category":"fisica","type":"cobertura","description":"P茅rdida y ganancia de cobertura arb贸rea entre 2000 y 2014, a nivel mundial, con una resoluci贸n de 30 m","url":"https://earthenginepartners.appspot.com/science-2013-global-forest"},{"name":"Riesgos de Desastres Naturales","region":"global","category":"fisica","type":"desastres","description":"Frecuencia de riesgos, mortalidad y riesgo de p茅rdidas econ贸micas. Abarca ciclones, sequ铆as, terremotos, inundaciones, deslizamientos y erupciones volc谩nicas","url":"https://preview.grid.unep.ch/"},{"name":"Base de Datos de Terremotos USGS","region":"global","category":"fisica","type":"desastres","description":"Archivos KML de todos los terremotos registrados por el USGS desde 1973 hasta la actualidad","url":"https://earthquake.usgs.gov/"},{"name":"IBTrACS - Huracanes y Ciclones","region":"global","category":"fisica","type":"desastres","description":"Trayectorias de huracanes y ciclones tropicales, incluyendo presi贸n m铆nima y vientos m谩ximos","url":"https://www.ncdc.noaa.gov/ibtracs/"},{"name":"ETOPO1 - Batimetr铆a","region":"global","category":"fisica","type":"elevacion","description":"Modelo de relieve con una resoluci贸n de 1 minuto de arco que incluye batimetr铆a oce谩nica","url":"https://www.ngdc.noaa.gov/mgg/global/"},{"name":"Ecorregiones Terrestres WWF","region":"global","category":"fisica","type":"ecologia","description":"Shapefile de ecorregiones seg煤n la definici贸n del Programa de Ciencias de la Conservaci贸n del WWF","url":"https://www.worldwildlife.org/publications/terrestrial-ecoregions-of-the-world"},{"name":"Informaci贸n Mundial sobre Suelos","region":"global","category":"fisica","type":"ecologia","description":"Datos en cuadr铆cula de suelos del mundo con 22 atributos por celda, incluyendo carbono org谩nico, yeso y capacidad h铆drica","url":"https://www.isric.org/"},{"name":"GADM - L铆mites Administrativos","region":"global","category":"humana","type":"limites","description":"L铆mites administrativos globales hasta cuatro niveles (pa铆ses, estados, departamentos, condados, etc.)","url":"https://gadm.org/"},{"name":"Poblaci贸n Mundial en Cuadr铆cula","region":"global","category":"humana","type":"poblacion","description":"Incluye poblaci贸n bruta, densidad de poblaci贸n, tanto hist贸rica, actual y prevista","url":"https://sedac.ciesin.columbia.edu/data/collection/gpw-v4"},{"name":"WorldPop","region":"global","category":"humana","type":"poblacion","description":"Datos contempor谩neos de alta resoluci贸n sobre la poblaci贸n de 脕frica, Asia, Am茅rica Central y del Sur","url":"https://www.worldpop.org/"},{"name":"OpenStreetMap","region":"global","category":"humana","type":"transporte","description":"Datos colaborativos de todo el mundo: puntos de inter茅s, edificios, carreteras, nombres de calles, rutas de ferry","url":"https://www.openstreetmap.org/"},{"name":"Huellas de Edificios Globales - Microsoft","region":"global","category":"humana","type":"limites","description":"Huellas de edificios globales derivadas mediante aprendizaje autom谩tico a partir de im谩genes a茅reas de Bing","url":"https://github.com/microsoft/GlobalMLBuildingFootprints"},{"name":"Capa Global de Asentamientos Humanos","region":"global","category":"humana","type":"poblacion","description":"Datos multitemporales sobre 谩reas construidas, poblaci贸n, asentamientos y grado de urbanizaci贸n","url":"https://ghsl.jrc.ec.europa.eu/"},{"name":"CROPGRIDS","region":"global","category":"fisica","type":"cobertura","description":"Conjunto de datos global que proporciona informaci贸n sobre el 谩rea de 173 cultivos alrededor del a帽o 2020, resoluci贸n ~5,6 km","url":"https://dataverse.harvard.edu/dataverse/cropgrids"},{"name":"Base de Datos Global de Embalses y Presas","region":"global","category":"fisica","type":"hidrologia","description":"Datos de todos los embalses con capacidad superior a 0,1 km鲁. Pol铆gonos de alta resoluci贸n con metadatos exhaustivos","url":"http://globaldamwatch.org/"},{"name":"Cuencas Hidrogr谩ficas del Mundo","region":"global","category":"fisica","type":"hidrologia","description":"Datos vectoriales que muestran los contornos de las principales cuencas hidrogr谩ficas en todo el mundo","url":"https://www.worldwildlife.org/pages/hydrosheds"},{"name":"Inventario del Glaciar Randolph","region":"global","category":"fisica","type":"clima","description":"Inventario global de contornos glaciares con datos multitemporales y enfoque en control de calidad","url":"https://www.glims.org/RGI/"},{"name":"脕rea Global de Tierras de Cultivo","region":"global","category":"humana","type":"cobertura","description":"Extensi贸n e intensidad de uso de tierras agr铆colas (cultivo y pastizales) en 2000 a partir de im谩genes MODIS y SPOT","url":"https://www.earthstat.org/"},{"name":"Open Flights","region":"global","category":"humana","type":"transporte","description":"Datos de aeropuertos, aerol铆neas y rutas de todo el mundo en archivos CSV procesables para SIG","url":"https://openflights.org/"},{"name":"脥ndice Mundial de Puertos","region":"global","category":"humana","type":"transporte","description":"Aproximadamente 3700 puertos en todo el mundo con ubicaci贸n y las instalaciones ofrecidas","url":"https://msi.nga.mil/NGAPortal/MSI.portal"},{"name":"Cables Submarinos de Telecomunicaciones","region":"global","category":"humana","type":"transporte","description":"Mapa de cables submarinos de telecomunicaciones de c贸digo abierto, actualizado frecuentemente","url":"https://www.submarinecablemap.com/"},{"name":"Base de Datos Espacial de 脕reas Protegidas","region":"global","category":"fisica","type":"ecologia","description":"Base de datos vectorial global de 谩reas protegidas marinas y terrestres","url":"https://www.protectedplanet.net/"},{"name":"Lista Roja UICN","region":"global","category":"fisica","type":"ecologia","description":"Shapefiles que muestran la distribuci贸n de especies de plantas y animales en peligro de extinci贸n","url":"https://www.iucnredlist.org/"},{"name":"MERIT DEM","region":"global","category":"fisica","type":"elevacion","description":"DEM de terreno mejorado con m煤ltiples errores eliminados, creado a partir de datos SRTM existentes","url":"http://hydro.iis.u-tokyo.ac.jp/~yamadai/MERIT_DEM/"},{"name":"ArcticDEM","region":"global","category":"fisica","type":"elevacion","description":"Modelos de elevaci贸n detallados de todas las 谩reas terrestres superiores a 60 grados norte","url":"https://www.pgc.umn.edu/data/arcticdem/"},{"name":"Proyecto Global de Climatolog铆a de Aerosoles","region":"global","category":"fisica","type":"clima","description":"Promedios mensuales del espesor 贸ptico de aerosoles y exponente Angstrom de 1981 a 2006","url":"https://aeronet.gsfc.nasa.gov/"},{"name":"Anchos Globales de R铆os de Landsat","region":"global","category":"fisica","type":"hidrologia","description":"Informaci贸n sobre anchos de r铆os (m谩ximo, m铆nimo, media) en todo el mundo derivado de datos Landsat","url":"https://zenodo.org/record/1297434"},{"name":"Huella Urbana Global","region":"global","category":"humana","type":"poblacion","description":"Mapa global de 谩reas edificadas con una resoluci贸n de 12 m","url":"https://www.nature.com/articles/sdata201896"},{"name":"WorldCereal","region":"global","category":"fisica","type":"cobertura","description":"Mapas globales de cultivos de cereales con una resoluci贸n de 10 m","url":"https://worldcereal.org/"},{"name":"Datos MODIS de Detecci贸n de Incendios","region":"global","category":"fisica","type":"desastres","description":"Datos actualizados frecuentemente (incluidos 煤ltimos 7 d铆as) de incendios en cuadr铆cula de 1 km","url":"https://firms.modaps.eosdis.nasa.gov/"}];

        let gisData = [];
        let gisFiltered = [];
        let gisEditIdx = -1;

        // Load from localStorage or default
        (function initGisData() {
            const saved = localStorage.getItem('geovisor_global_gis');
            if (saved) {
                try { 
                    const loadedData = JSON.parse(saved);
                    // Filtrar SOLO datos globales, eliminar cualquier dato de pa铆ses
                    gisData = loadedData.filter(d => d.region === 'global');
                    // Si se eliminaron datos, guardar la versi贸n limpia
                    if (gisData.length !== loadedData.length) {
                        localStorage.setItem('geovisor_global_gis', JSON.stringify(gisData));
                        console.log('Se limpiaron fuentes no globales del panel de datos globales');
                    }
                } catch(e) { 
                    gisData = [...gisDataDefault]; 
                }
            } else {
                gisData = [...gisDataDefault];
            }
            gisFiltered = [...gisData];
        })();

        function saveGisData() {
            localStorage.setItem('geovisor_global_gis', JSON.stringify(gisData));
        }

        function toggleLeftPanel() {
            const panel = document.getElementById('leftPanel');
            panel.classList.toggle('active');
            document.body.classList.toggle('left-panel-open');
            if (panel.classList.contains('active')) {
                filtrarGlobal();
            }
            setTimeout(() => { if (map) map.invalidateSize(); }, 350);
        }

        function filtrarGlobal() {
            const cat = document.getElementById('gCategory').value;
            const type = document.getElementById('gType').value;
            const search = document.getElementById('gSearch').value.toLowerCase();

            gisFiltered = gisData.filter(d => {
                return d.region === 'global' &&
                       (cat === 'all' || d.category === cat) &&
                       (type === 'all' || d.type === type) &&
                       (search === '' || d.name.toLowerCase().includes(search) || d.description.toLowerCase().includes(search));
            });

            renderGisCards();
            updateGisStats();
        }

        function updateGisStats() {
            const globalOnly = gisData.filter(d => d.region === 'global');
            document.getElementById('gTotal').textContent = gisFiltered.length;
            document.getElementById('gFisica').textContent = globalOnly.filter(d => d.category === 'fisica').length;
            document.getElementById('gHumana').textContent = globalOnly.filter(d => d.category === 'humana').length;
            document.getElementById('fabGlobalCount').textContent = globalOnly.length;
        }

        const typeLabels = {elevacion:'Elevaci贸n',clima:'Clima',hidrologia:'Hidrolog铆a',cobertura:'Cobertura',limites:'L铆mites',poblacion:'Poblaci贸n',transporte:'Transporte',ecologia:'Ecolog铆a',desastres:'Desastres',geologia:'Geolog铆a'};

        function renderGisCards() {
            const container = document.getElementById('gList');
            if (gisFiltered.length === 0) {
                container.innerHTML = '<div style="text-align:center;padding:40px;color:#999;"><p style="font-size:40px;">馃攳</p><p>Sin resultados</p></div>';
                return;
            }
            container.innerHTML = gisFiltered.map((item, fi) => {
                const realIdx = gisData.indexOf(item);
                const url = (item.url || '').replace(/'/g, "\\'");
                return `<div class="gis-card">
                    <div class="gc-actions" onclick="event.stopPropagation();">
                        <button type="button" class="gc-edit" onclick="event.stopPropagation(); editarGlobal(${realIdx})" title="Editar">鉁忥笍</button>
                        <button type="button" class="gc-del" onclick="event.stopPropagation(); eliminarGlobal(${realIdx})" title="Eliminar">馃棏锔?/button>
                    </div>
                    <div class="gc-name">${item.name}</div>
                    <div class="gc-desc">${item.description}</div>
                    <div class="gc-footer">
                        <div>
                            
                            <span class="gc-badge ${item.category}">${item.category === 'fisica' ? 'F铆sica' : 'Humana'}</span>
                            <span style="font-size:10px;color:#888;margin-left:4px;">馃搧 ${typeLabels[item.type] || item.type}</span>
                        </div>
                        ${item.url ? `<a href="${item.url}" target="_blank" class="gc-link" onclick="event.stopPropagation();">Acceder 鈫?/a>` : ''}
                    </div>
                </div>`;
            }).join('');
        }

        function abrirModalGlobal() {
            gisEditIdx = -1;
            document.getElementById('gModalTitle').textContent = '鉃?Agregar Fuente Global';
            document.getElementById('gBtnSave').textContent = 'Guardar';
            document.getElementById('gf1').value = '';
            document.getElementById('gf3').value = '';
            document.getElementById('gf4').value = '';
            document.getElementById('gf5').value = '';
            document.getElementById('gf6').value = '';
            document.getElementById('modalGlobal').style.display = 'block';
        }

        function cerrarModalGlobal() {
            document.getElementById('modalGlobal').style.display = 'none';
        }

        function editarGlobal(idx) {
            gisEditIdx = idx;
            const item = gisData[idx];
            document.getElementById('gModalTitle').textContent = '鉁忥笍 Editar Fuente Global';
            document.getElementById('gBtnSave').textContent = 'Actualizar';
            document.getElementById('gf1').value = item.name;
            // region always global
            document.getElementById('gf3').value = item.category;
            document.getElementById('gf4').value = item.type;
            document.getElementById('gf5').value = item.description;
            document.getElementById('gf6').value = item.url || '';
            document.getElementById('modalGlobal').style.display = 'block';
        }

        function eliminarGlobal(idx) {
            const item = gisData[idx];
            // Validar que sea una fuente global
            if (item.region !== 'global') {
                mostrarNotificacion('鈿狅笍 Esta fuente no es global y no deber铆a estar aqu铆');
                return;
            }
            if (!confirm('驴Eliminar "' + item.name + '"?\n\nEsta acci贸n no se puede deshacer.')) return;
            gisData.splice(idx, 1);
            saveGisData();
            filtrarGlobal();
            mostrarNotificacion('鉁?"' + item.name + '" eliminado');
        }

        function guardarGlobal() {
            const name = document.getElementById('gf1').value.trim();
            const region = 'global'; // SIEMPRE global, no importa si es nuevo o edici贸n
            const category = document.getElementById('gf3').value;
            const type = document.getElementById('gf4').value;
            const description = document.getElementById('gf5').value.trim();
            const url = document.getElementById('gf6').value.trim();

            if (!name || !category || !type || !description) {
                alert('Por favor completa todos los campos obligatorios (*)');
                return;
            }

            const item = { name, region, category, type, description, url };

            if (gisEditIdx >= 0) {
                // Al editar, forzar region='global' para prevenir corrupci贸n de datos
                gisData[gisEditIdx] = item;
                mostrarNotificacion('鉁?"' + name + '" actualizado');
            } else {
                gisData.push(item);
                mostrarNotificacion('鉁?"' + name + '" agregado. Total: ' + gisData.filter(d => d.region === 'global').length);
            }

            saveGisData();
            filtrarGlobal();
            cerrarModalGlobal();
            gisEditIdx = -1;
        }

        // Init global panel on load
        document.addEventListener('DOMContentLoaded', function() {
            filtrarGlobal();
        });

        // Close global modal on outside click
        window.addEventListener('click', function(e) {
            if (e.target.id === 'modalGlobal') cerrarModalGlobal();
        });

    </script>

    <div id="modalFormulario" class="modal-form">
        <div class="modal-box">
            <div class="modal-head">
                <h2 id="modalTitulo">鉃?Agregar Nueva Fuente GIS</h2>
                <p>Pa铆s: <span id="paisForm"></span></p>
            </div>
            <div class="modal-body">
                <div class="grupo">
                    <label>Nombre de la Fuente <span class="req">*</span></label>
                    <input type="text" id="f1" placeholder="Ej: Instituto Geogr谩fico Nacional">
                </div>
                <div class="grupo">
                    <label>Tipo de Archivo <span class="req">*</span></label>
                    <select id="f2">
                        <option value="">Seleccionar...</option>
                        <option value=".shp">Shapefile (.shp)</option>
                        <option value=".geotiff">GeoTIFF</option>
                        <option value=".kml">KML</option>
                        <option value=".geojson">GeoJSON</option>
                        <option value="WMS">WMS</option>
                        <option value="WFS">WFS</option>
                        <option value="API">API</option>
                        <option value="Otro">Otro</option>
                    </select>
                </div>
                <div class="grupo">
                    <label>Enlace URL</label>
                    <input type="text" id="f3" placeholder="https://ejemplo.com (opcional)">
                </div>
                <div class="grupo">
                    <label>Capas Disponibles <span class="req">*</span></label>
                    <textarea id="f4" placeholder="L铆mites administrativos, Red vial, etc."></textarea>
                </div>
            </div>
            <div class="modal-foot">
                <button class="btn-modal btn-sec" onclick="cerrarFormulario()">Cancelar</button>
                <button class="btn-modal btn-pri" id="btnGuardar" onclick="guardarFuente()">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal Agregar/Editar Fuente Global -->
    <div id="modalGlobal" class="modal-gis">
        <div class="modal-box">
            <div class="modal-head">
                <h2 id="gModalTitle">鉃?Agregar Fuente Global</h2>
                <p>Fuente de datos GIS mundial</p>
            </div>
            <div class="modal-body">
                <div class="grupo">
                    <label>Nombre <span class="req">*</span></label>
                    <input type="text" id="gf1" placeholder="Ej: Natural Earth, WorldClim...">
                </div>
                
                <div class="grupo">
                    <label>Categor铆a <span class="req">*</span></label>
                    <select id="gf3">
                        <option value="">Seleccionar...</option>
                        <option value="fisica">Geograf铆a F铆sica</option>
                        <option value="humana">Geograf铆a Humana</option>
                    </select>
                </div>
                <div class="grupo">
                    <label>Tipo de Dato <span class="req">*</span></label>
                    <select id="gf4">
                        <option value="">Seleccionar...</option>
                        <option value="elevacion">Elevaci贸n</option>
                        <option value="clima">Clima</option>
                        <option value="hidrologia">Hidrolog铆a</option>
                        <option value="cobertura">Cobertura Terrestre</option>
                        <option value="limites">L铆mites</option>
                        <option value="poblacion">Poblaci贸n</option>
                        <option value="transporte">Transporte</option>
                        <option value="ecologia">Ecolog铆a</option>
                        <option value="desastres">Desastres</option>
                        <option value="geologia">Geolog铆a</option>
                    </select>
                </div>
                <div class="grupo">
                    <label>Descripci贸n <span class="req">*</span></label>
                    <textarea id="gf5" placeholder="Descripci贸n de la fuente de datos..."></textarea>
                </div>
                <div class="grupo">
                    <label>URL de Acceso</label>
                    <input type="text" id="gf6" placeholder="https://ejemplo.com">
                </div>
            </div>
            <div class="modal-foot">
                <button class="btn-modal btn-sec" onclick="cerrarModalGlobal()">Cancelar</button>
                <button class="btn-modal btn-pri" id="gBtnSave" onclick="guardarGlobal()" style="background:#059669;">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Modal Agregar Nuevo Pa铆s -->
    <div id="modalNuevoPais" class="modal-pais">
        <div class="modal-box">
            <div class="modal-head">
                <h2>馃實 Agregar Nuevo Pa铆s</h2>
                <p>Crea un punto en el mapa y empieza a cargar fuentes GIS</p>
            </div>
            <div class="modal-body">
                <div class="grupo">
                    <label>Nombre del Pa铆s <span class="req">*</span></label>
                    <input type="text" id="npNombre" placeholder="Ej: Costa Rica, Honduras, Guatemala...">
                </div>
                <div class="grupo">
                    <label>Bandera / 脥cono</label>
                    <div class="emoji-grid" id="emojiGrid"></div>
                </div>
                <div class="grupo">
                    <label>Ubicaci贸n en el Mapa <span class="req">*</span></label>
                    <div class="coord-picker-area" id="coordPicker" onclick="iniciarPicking()">
                        <div class="coord-icon">馃搷</div>
                        <div class="coord-text">Haz clic aqu铆 y luego en el mapa para seleccionar la ubicaci贸n</div>
                        <div class="coord-values" id="coordValues" style="display:none;"></div>
                    </div>
                </div>
            </div>
            <div class="modal-foot">
                <button class="btn-modal btn-sec" onclick="cerrarModalPais()">Cancelar</button>
                <button class="btn-modal btn-pri" onclick="guardarNuevoPais()">Crear Pa铆s</button>
            </div>
        </div>
    </div>

</body>
</html>
